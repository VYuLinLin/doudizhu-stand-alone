{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\gameScene/assets\\scripts\\gameScene\\gameingUI.js"],"names":["cc","Class","Component","properties","gameingUI","Node","card_prefab","Prefab","robUI","bottom_card_pos_node","playingUI_node","tipsLabel","Label","fapai","type","AudioClip","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","myglobal","socket","onCanRobState","data","console","log","JSON","stringify","playerData","userId","active","bind","onCanChuCard","clearOutZone","onOtherPlayerChuCard","accountid","gameScene_script","node","parent","getComponent","outCard_node","getUserOutCardPosByAccount","node_cards","i","cards","length","card","instantiate","showCards","card_data","push","appendOtherCardsToOutZone","on","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","isopen_sound","audioEngine","play","url","raw","master_accountid","scheduleOnce","pushThreeCard","event","detail","cardid","splice","start","window","$socket","pushCardNotify","onDestroy","remove","cur_index_card","pushCard","_runactive_pushcard","emit","stop","fapai_audioID","sendevent","move_node","common","audio","PlayEffect","newx","x","action","moveTo","v2","sortCard","sort","y","a","b","hasOwnProperty","value","king","timeout","setTimeout","zIndex","width","scale","di_card","position","schedulePushThreeCard","last_card_x","destoryCard","choose_card","destroy_card","j","card_id","removeFromParent","appendCardsToOutZone","updateCards","children","destroy","removeAllChildren","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","playPushCardSound","card_name","CardsValue","one","name","onButtonClick","customData","requestRobState","qian_state","qian","buqiang","request_buchu_card","string","request_chu_card","err","msg","cardvalue","account"],"mappings":";;;;;;AAAA;;;;AAEAA,EAAE,CAACC,KAAH,CAAS;AACP,aAASD,EAAE,CAACE,SADL;AAGPC,EAAAA,UAAU,EAAE;AACVC,IAAAA,SAAS,EAAEJ,EAAE,CAACK,IADJ;AAEVC,IAAAA,WAAW,EAAEN,EAAE,CAACO,MAFN;AAGVC,IAAAA,KAAK,EAAER,EAAE,CAACK,IAHA;AAIVI,IAAAA,oBAAoB,EAAET,EAAE,CAACK,IAJf;AAIqB;AAC/BK,IAAAA,cAAc,EAAEV,EAAE,CAACK,IALT;AAMVM,IAAAA,SAAS,EAAEX,EAAE,CAACY,KANJ;AAMW;AACrBC,IAAAA,KAAK,EAAE;AACLC,MAAAA,IAAI,EAAEd,EAAE,CAACe,SADJ;AAEL,iBAAS;AAFJ;AAPG,GAHL;AAiBPC,EAAAA,MAjBO,oBAiBE;AACP;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,UAAL,GAAkB,CAAlB,CAHO,CAIP;;AACA,SAAKC,oBAAL,GAA4B,CAA5B,CALO,CAMP;;AACA,SAAKC,SAAL,GAAiB,KAAjB,CAPO,CAQP;;AACA,SAAKC,WAAL,GAAmB,EAAnB,CATO,CAUP;;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,WAAL,GAAmB,EAAnB;AAEA,SAAKC,aAAL,GAAqB,EAArB,CAfO,CAiBP;;AACAC,yBAASC,MAAT,CAAgBC,aAAhB,CAA8B,UAAUC,IAAV,EAAgB;AAC5CC,MAAAA,OAAO,CAACC,GAAR,CAAY,kBAAkBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA9B,EAD4C,CAE5C;;AACA,WAAKV,oBAAL,GAA4BU,IAA5B;;AACA,UAAIA,IAAI,IAAIH,qBAASQ,UAAT,CAAoBC,MAA5B,IAAsC,KAAKf,SAAL,IAAkB,IAA5D,EAAkE;AAChE,aAAKZ,KAAL,CAAW4B,MAAX,GAAoB,IAApB;AACD;AAEF,KAR6B,CAQ5BC,IAR4B,CAQvB,IARuB,CAA9B,EAlBO,CA4BP;;;AACAX,yBAASC,MAAT,CAAgBW,YAAhB,CAA6B,UAAUT,IAAV,EAAgB;AAC3CC,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAiBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA7B,EAD2C,CAE3C;;AACA,UAAIA,IAAI,IAAIH,qBAASQ,UAAT,CAAoBC,MAAhC,EAAwC;AACtC;AACA,aAAKI,YAAL,CAAkBb,qBAASQ,UAAT,CAAoBC,MAAtC,EAFsC,CAGtC;AACA;AACA;;AACA,aAAKzB,cAAL,CAAoB0B,MAApB,GAA6B,IAA7B;AAED;AACF,KAZ4B,CAY3BC,IAZ2B,CAYtB,IAZsB,CAA7B,EA7BO,CA2CP;;;AACAX,yBAASC,MAAT,CAAgBa,oBAAhB,CAAqC,UAAUX,IAAV,EAAgB;AACnD;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAyBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAArC;AAEA,UAAIY,SAAS,GAAGZ,IAAI,CAACY,SAArB;AACA,UAAIC,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB,CALmD,CAMnD;;AACA,UAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;;AACA,UAAIK,YAAY,IAAI,IAApB,EAA0B;AACxB;AACD;;AAED,UAAIE,UAAU,GAAG,EAAjB;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGpB,IAAI,CAACqB,KAAL,CAAWC,MAA/B,EAAuCF,CAAC,EAAxC,EAA4C;AAC1C,YAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,QAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoCzB,IAAI,CAACqB,KAAL,CAAWD,CAAX,EAAcM,SAAlD,EAA6D7B,qBAASQ,UAAT,CAAoBC,MAAjF;AACAa,QAAAA,UAAU,CAACQ,IAAX,CAAgBJ,IAAhB;AACD;;AACD,WAAKK,yBAAL,CAA+BX,YAA/B,EAA6CE,UAA7C,EAAyD,CAAzD;AAGD,KArBoC,CAqBnCX,IArBmC,CAqB9B,IArB8B,CAArC,EA5CO,CAmEP;;;AACA,SAAKM,IAAL,CAAUe,EAAV,CAAa,wBAAb,EAAuC,UAAU7B,IAAV,EAAgB;AACrDC,MAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0C,CAACF,IAA3C;AAEA,WAAKP,gBAAL,GAAwBO,IAAxB;;AAEA,WAAK,IAAIoB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGpB,IAAI,CAACsB,MAAzB,EAAiCF,CAAC,EAAlC,EAAsC;AACpC,YAAIG,IAAI,GAAG,KAAK/B,WAAL,CAAiB4B,CAAjB,CAAX;AACA,YAAIU,SAAS,GAAG9B,IAAI,CAACoB,CAAD,CAApB;AACA,YAAIW,SAAS,GAAG;AACd,iBAAOR,IADO;AAEd,kBAAQO;AAFM,SAAhB;AAIA7B,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsBC,IAAI,CAACC,SAAL,CAAe0B,SAAf,CAAlC;AACA,YAAIE,GAAG,GAAG7D,EAAE,CAAC8D,QAAH,CAAY,UAAUC,MAAV,EAAkBC,UAAlB,EAA8B;AAElD,cAAIC,SAAS,GAAGD,UAAU,CAACE,GAA3B;AACA,cAAIP,SAAS,GAAGK,UAAU,CAACnC,IAA3B,CAHkD,CAIlD;;AACAoC,UAAAA,SAAS,CAACpB,YAAV,CAAuB,MAAvB,EAA+BS,SAA/B,CAAyCK,SAAzC;AAED,SAPS,EAOP,IAPO,EAODC,SAPC,CAAV;AASAR,QAAAA,IAAI,CAACe,SAAL,CAAenE,EAAE,CAACoE,QAAH,CAAYpE,EAAE,CAACqE,QAAH,CAAY,CAAZ,EAAe,CAAf,EAAkB,GAAlB,CAAZ,EAAoCrE,EAAE,CAACqE,QAAH,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAAC,EAArB,CAApC,EAA8DR,GAA9D,EACb7D,EAAE,CAACqE,QAAH,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAAC,EAArB,CADa,EACarE,EAAE,CAACsE,OAAH,CAAW,CAAX,EAAc,GAAd,CADb,CAAf;;AAGA,YAAIC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,2BAAX,CAApB;AACD;AACF,OA5BoD,CA8BrD;AACA;;;AACA,UAAIjD,qBAASQ,UAAT,CAAoBC,MAApB,IAA8BT,qBAASQ,UAAT,CAAoB0C,gBAAtD,EAAwE;AACtE,aAAKC,YAAL,CAAkB,KAAKC,aAAL,CAAmBzC,IAAnB,CAAwB,IAAxB,CAAlB,EAAiD,GAAjD;AACD;AAGF,KArCsC,CAqCrCA,IArCqC,CAqChC,IArCgC,CAAvC,EApEO,CA2GP;;AACA,SAAKM,IAAL,CAAUe,EAAV,CAAa,mBAAb,EAAkC,UAAUqB,KAAV,EAAiB;AACjDjD,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAuBC,IAAI,CAACC,SAAL,CAAe8C,KAAf,CAAnC;AACA,UAAIC,MAAM,GAAGD,KAAb;AACA,WAAKxD,gBAAL,CAAsBiC,IAAtB,CAA2BwB,MAA3B;AACD,KAJiC,CAIhC3C,IAJgC,CAI3B,IAJ2B,CAAlC;AAMA,SAAKM,IAAL,CAAUe,EAAV,CAAa,qBAAb,EAAoC,UAAUqB,KAAV,EAAiB;AACnDjD,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAyBgD,KAArC;AACA,UAAIC,MAAM,GAAGD,KAAb;;AACA,WAAK,IAAI9B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1B,gBAAL,CAAsB4B,MAA1C,EAAkDF,CAAC,EAAnD,EAAuD;AACrD,YAAI,KAAK1B,gBAAL,CAAsB0B,CAAtB,EAAyBgC,MAAzB,IAAmCD,MAAvC,EAA+C;AAC7C,eAAKzD,gBAAL,CAAsB2D,MAAtB,CAA6BjC,CAA7B,EAAgC,CAAhC;AACD;AACF;AACF,KARmC,CAQlCZ,IARkC,CAQ7B,IAR6B,CAApC;AAUD,GA7IM;AA+IP8C,EAAAA,KA/IO,mBA+IC;AACN;AACAC,IAAAA,MAAM,CAACC,OAAP,CAAe3B,EAAf,CAAkB,iBAAlB,EAAqC,KAAK4B,cAA1C,EAA0D,IAA1D;AACD,GAlJM;AAmJPC,EAAAA,SAnJO,uBAmJK;AACVH,IAAAA,MAAM,CAACC,OAAP,CAAeG,MAAf,CAAsB,iBAAtB,EAAyC,IAAzC;AACD,GArJM;AAsJPF,EAAAA,cAtJO,0BAsJQzD,IAtJR,EAsJc;AACnBC,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA5B;AACA,SAAK0B,SAAL,GAAiB1B,IAAjB;AACA,SAAK4D,cAAL,GAAsB5D,IAAI,CAACsB,MAAL,GAAc,CAApC;AACA,SAAKuC,QAAL,CAAc7D,IAAd,EAJmB,CAKnB;;AACA,SAAKgD,YAAL,CAAkB,KAAKc,mBAAL,CAAyBtD,IAAzB,CAA8B,IAA9B,CAAlB,EAAuD,GAAvD;AACA,SAAKM,IAAL,CAAUC,MAAV,CAAiBgD,IAAjB,CAAsB,sBAAtB;AAED,GA/JM;AAgKP;AACAD,EAAAA,mBAjKO,iCAiKe;AACpB,QAAI,KAAKF,cAAL,GAAsB,CAA1B,EAA6B;AAC3B3D,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAD2B,CAE3B;AACA;;AACA,WAAKX,SAAL,GAAiB,IAAjB;;AACA,UAAI,KAAKD,oBAAL,IAA6BO,qBAASQ,UAAT,CAAoBC,MAArD,EAA6D;AAC3D,aAAK3B,KAAL,CAAW4B,MAAX,GAAoB,IAApB;AACD;;AAED,UAAImC,YAAJ,EAAkB;AAChB;AACAvE,QAAAA,EAAE,CAACwE,WAAH,CAAeqB,IAAf,CAAoB,KAAKC,aAAzB;AACD,OAZ0B,CAe3B;;;AACA,UAAIC,SAAS,GAAG,KAAK5E,oBAArB;AACA,WAAKwB,IAAL,CAAUC,MAAV,CAAiBgD,IAAjB,CAAsB,cAAtB,EAAsCG,SAAtC;AAEA;AACD,KArBmB,CAuBpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,QAAIC,SAAS,GAAG,KAAK/E,UAAL,CAAgB,KAAKA,UAAL,CAAgBkC,MAAhB,GAAyB,KAAKsC,cAA9B,GAA+C,CAA/D,CAAhB;AACAO,IAAAA,SAAS,CAAC5D,MAAV,GAAmB,IAAnB;AACA,SAAKX,aAAL,CAAmB+B,IAAnB,CAAwBwC,SAAxB;AACA,SAAKF,aAAL,GAAqBG,MAAM,CAACC,KAAP,CAAaC,UAAb,CAAwB,KAAKtF,KAA7B,CAArB;;AACA,SAAK,IAAIoC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKxB,aAAL,CAAmB0B,MAAnB,GAA4B,CAAhD,EAAmDF,CAAC,EAApD,EAAwD;AACtD,UAAI+C,SAAS,GAAG,KAAKvE,aAAL,CAAmBwB,CAAnB,CAAhB;AACA,UAAImD,IAAI,GAAGJ,SAAS,CAACK,CAAV,GAAe,KAAKnF,UAAL,GAAkB,GAA5C;AACA,UAAIoF,MAAM,GAAGtG,EAAE,CAACuG,MAAH,CAAU,GAAV,EAAevG,EAAE,CAACwG,EAAH,CAAMJ,IAAN,EAAY,CAAC,GAAb,CAAf,CAAb;AACAJ,MAAAA,SAAS,CAAC7B,SAAV,CAAoBmC,MAApB;AACD;;AAED,SAAKb,cAAL;AACA,SAAKZ,YAAL,CAAkB,KAAKc,mBAAL,CAAyBtD,IAAzB,CAA8B,IAA9B,CAAlB,EAAuD,GAAvD;AACD,GA/MM;AAiNP;AACAoE,EAAAA,QAlNO,sBAkNI;AACT,SAAKxF,UAAL,CAAgByF,IAAhB,CAAqB,UAAUL,CAAV,EAAaM,CAAb,EAAgB;AACnC,UAAIC,CAAC,GAAGP,CAAC,CAACxD,YAAF,CAAe,MAAf,EAAuBU,SAA/B;AACA,UAAIsD,CAAC,GAAGF,CAAC,CAAC9D,YAAF,CAAe,MAAf,EAAuBU,SAA/B;;AAEA,UAAIqD,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,eAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,UAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAC,CAAR;AACD;;AACD,UAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAP;AACD;;AACD,UAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,eAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,KAhBD,EADS,CAkBT;AACA;AACA;;AACA,QAAIC,OAAO,GAAG,IAAd;AACAC,IAAAA,UAAU,CAAC,YAAY;AACrB;AACA,UAAIb,CAAC,GAAG,KAAKpF,UAAL,CAAgB,CAAhB,EAAmBoF,CAA3B;AACAvE,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAYsE,CAAxB;;AACA,WAAK,IAAIpD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhC,UAAL,CAAgBkC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,YAAIG,IAAI,GAAG,KAAKnC,UAAL,CAAgBgC,CAAhB,CAAX;AACAG,QAAAA,IAAI,CAAC+D,MAAL,GAAclE,CAAd,CAF+C,CAE9B;;AACjBG,QAAAA,IAAI,CAACiD,CAAL,GAASA,CAAC,GAAGjD,IAAI,CAACgE,KAAL,GAAa,GAAb,GAAmBnE,CAAhC;AACD;AACF,KATU,CASTZ,IATS,CASJ,IATI,CAAD,EASI4E,OATJ,CAAV;AAYD,GApPM;AAuPPvB,EAAAA,QAvPO,oBAuPE7D,IAvPF,EAuPQ;AACb,QAAIA,IAAJ,EAAU;AACRA,MAAAA,IAAI,CAAC6E,IAAL,CAAU,UAAUE,CAAV,EAAaC,CAAb,EAAgB;AACxB,YAAID,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,iBAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,YAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,iBAAO,CAAC,CAAR;AACD;;AACD,YAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,iBAAO,CAAP;AACD;;AACD,YAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,iBAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,OAbD;AAcD,KAhBY,CAiBb;;;AACA,SAAK/F,UAAL,GAAkB,EAAlB;;AACA,SAAK,IAAIgC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAE3B,UAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,MAAAA,IAAI,CAACiE,KAAL,GAAa,GAAb;AACAjE,MAAAA,IAAI,CAACR,MAAL,GAAc,KAAKD,IAAL,CAAUC,MAAxB;AACAQ,MAAAA,IAAI,CAACiD,CAAL,GAASjD,IAAI,CAACgE,KAAL,GAAa,GAAb,GAAoB,CAAC,GAArB,GAA6B,CAAC,EAA9B,GAAoChE,IAAI,CAACgE,KAAL,GAAa,GAAb,GAAmB,CAAhE,CAL2B,CAM3B;;AACAhE,MAAAA,IAAI,CAACuD,CAAL,GAAS,CAAC,GAAV;AACAvD,MAAAA,IAAI,CAAChB,MAAL,GAAc,KAAd;AAEAgB,MAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoCzB,IAAI,CAACoB,CAAD,CAAxC,EAA6CvB,qBAASQ,UAAT,CAAoBC,MAAjE,EAV2B,CAW3B;;AACA,WAAKlB,UAAL,CAAgBuC,IAAhB,CAAqBJ,IAArB;AACA,WAAKlC,UAAL,GAAkBkC,IAAI,CAACgE,KAAvB;AACD,KAjCY,CAmCb;;;AACA,SAAK/F,WAAL,GAAmB,EAAnB;;AACA,SAAK,IAAI4B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,UAAIqE,OAAO,GAAGtH,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAd;AACAgH,MAAAA,OAAO,CAACD,KAAR,GAAgB,GAAhB;AACAC,MAAAA,OAAO,CAACC,QAAR,GAAmB,KAAK9G,oBAAL,CAA0B8G,QAA7C,CAH0B,CAI1B;AACA;;AACA,UAAItE,CAAC,IAAI,CAAT,EAAY;AACVqE,QAAAA,OAAO,CAACjB,CAAR,GAAYiB,OAAO,CAACjB,CAAR,GAAYiB,OAAO,CAACF,KAAR,GAAgB,GAAxC;AACD,OAFD,MAEO,IAAInE,CAAC,IAAI,CAAT,EAAY;AACjBqE,QAAAA,OAAO,CAACjB,CAAR,GAAYiB,OAAO,CAACjB,CAAR,GAAYiB,OAAO,CAACF,KAAR,GAAgB,GAAxC;AACD,OAVyB,CAa1B;AACA;;;AACAE,MAAAA,OAAO,CAAC1E,MAAR,GAAiB,KAAKD,IAAL,CAAUC,MAA3B,CAf0B,CAgB1B;;AACA,WAAKvB,WAAL,CAAiBmC,IAAjB,CAAsB8D,OAAtB;AACD;AAEF,GAhTM;AAkTP;AACAE,EAAAA,qBAnTO,mCAmTiB;AACtB,SAAK,IAAIvE,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhC,UAAL,CAAgBkC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,UAAIG,IAAI,GAAG,KAAKnC,UAAL,CAAgBgC,CAAhB,CAAX;;AACA,UAAIG,IAAI,CAACuD,CAAL,IAAU,CAAC,GAAf,EAAoB;AAClBvD,QAAAA,IAAI,CAACuD,CAAL,GAAS,CAAC,GAAV;AACD;AACF;AACF,GA1TM;AA2TP;AACA7B,EAAAA,aA5TO,2BA4TS;AACd;AACA,QAAI2C,WAAW,GAAG,KAAKxG,UAAL,CAAgB,KAAKA,UAAL,CAAgBkC,MAAhB,GAAyB,CAAzC,EAA4CkD,CAA9D;;AACA,SAAK,IAAIpD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK3B,gBAAL,CAAsB6B,MAA1C,EAAkDF,CAAC,EAAnD,EAAuD;AACrD,UAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,MAAAA,IAAI,CAACiE,KAAL,GAAa,GAAb;AACAjE,MAAAA,IAAI,CAACR,MAAL,GAAc,KAAKD,IAAL,CAAUC,MAAxB;AAEAQ,MAAAA,IAAI,CAACiD,CAAL,GAASoB,WAAW,GAAI,CAACxE,CAAC,GAAG,CAAL,IAAU,KAAK/B,UAAf,GAA4B,GAApD;AACAkC,MAAAA,IAAI,CAACuD,CAAL,GAAS,CAAC,GAAV,CANqD,CAMtC;AAEf;;AACAvD,MAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoC,KAAKhC,gBAAL,CAAsB2B,CAAtB,CAApC,EAA8DvB,qBAASQ,UAAT,CAAoBC,MAAlF;AACAiB,MAAAA,IAAI,CAAChB,MAAL,GAAc,IAAd;AACA,WAAKnB,UAAL,CAAgBuC,IAAhB,CAAqBJ,IAArB;AACD;;AAED,SAAKqD,QAAL,GAjBc,CAkBd;;AACA,SAAK5B,YAAL,CAAkB,KAAK2C,qBAAL,CAA2BnF,IAA3B,CAAgC,IAAhC,CAAlB,EAAyD,CAAzD;AAED,GAjVM;AAmVPqF,EAAAA,WAnVO,uBAmVKjF,SAnVL,EAmVgBkF,WAnVhB,EAmV6B;AAClC,QAAIA,WAAW,CAACxE,MAAZ,IAAsB,CAA1B,EAA6B;AAC3B;AACD;AAED;;;;;;;;;;AAUA;;;AACA,QAAIyE,YAAY,GAAG,EAAnB;;AACA,SAAK,IAAI3E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG0E,WAAW,CAACxE,MAAhC,EAAwCF,CAAC,EAAzC,EAA6C;AAC3C,WAAK,IAAI4E,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK5G,UAAL,CAAgBkC,MAApC,EAA4C0E,CAAC,EAA7C,EAAiD;AAC/C,YAAIC,OAAO,GAAG,KAAK7G,UAAL,CAAgB4G,CAAhB,EAAmBhF,YAAnB,CAAgC,MAAhC,EAAwCiF,OAAtD;;AACA,YAAIA,OAAO,IAAIH,WAAW,CAAC1E,CAAD,CAAX,CAAegC,MAA9B,EAAsC;AACpCnD,UAAAA,OAAO,CAACC,GAAR,CAAY,qBAAqB+F,OAAjC,EADoC,CAEpC;;AACA,eAAK7G,UAAL,CAAgB4G,CAAhB,EAAmBE,gBAAnB,CAAoC,IAApC;AACAH,UAAAA,YAAY,CAACpE,IAAb,CAAkB,KAAKvC,UAAL,CAAgB4G,CAAhB,CAAlB;AACA,eAAK5G,UAAL,CAAgBiE,MAAhB,CAAuB2C,CAAvB,EAA0B,CAA1B;AACD;AACF;AACF;;AAED,SAAKG,oBAAL,CAA0BvF,SAA1B,EAAqCmF,YAArC;AACA,SAAKK,WAAL;AAED,GApXM;AAsXP;AACA1F,EAAAA,YAvXO,wBAuXME,SAvXN,EAuXiB;AACtB,QAAIC,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB;AACA,QAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;AACA,QAAIyF,QAAQ,GAAGpF,YAAY,CAACoF,QAA5B;;AACA,SAAK,IAAIjF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGiF,QAAQ,CAAC/E,MAA7B,EAAqCF,CAAC,EAAtC,EAA0C;AACxC,UAAIG,IAAI,GAAG8E,QAAQ,CAACjF,CAAD,CAAnB;AACAG,MAAAA,IAAI,CAAC+E,OAAL;AACD;;AACDrF,IAAAA,YAAY,CAACsF,iBAAb,CAA+B,IAA/B;AACD,GAhYM;AAiYP;AACAC,EAAAA,YAlYO,wBAkYMnF,KAlYN,EAkYa;AAClB,QAAIA,KAAK,CAACC,MAAN,IAAgB,CAApB,EAAuB;AACrB;AACD;;AACDD,IAAAA,KAAK,CAACwD,IAAN,CAAW,UAAUL,CAAV,EAAaM,CAAb,EAAgB;AACzB,UAAIC,CAAC,GAAGP,CAAC,CAACxD,YAAF,CAAe,MAAf,EAAuBU,SAA/B;AACA,UAAIsD,CAAC,GAAGF,CAAC,CAAC9D,YAAF,CAAe,MAAf,EAAuBU,SAA/B;;AAEA,UAAIqD,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,eAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,UAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAC,CAAR;AACD;;AACD,UAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAP;AACD;;AACD,UAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,eAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,KAhBD;AAiBD,GAvZM;AAyZPvD,EAAAA,yBAzZO,qCAyZmBX,YAzZnB,EAyZiCI,KAzZjC,EAyZwCoF,OAzZxC,EAyZiD;AACtDxF,IAAAA,YAAY,CAACsF,iBAAb,CAA+B,IAA/B,EADsD,CAGtD;AACA;;AACA,SAAK,IAAInF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,KAAK,CAACC,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AACrC,UAAIG,IAAI,GAAGF,KAAK,CAACD,CAAD,CAAhB;AACAH,MAAAA,YAAY,CAACyF,QAAb,CAAsBnF,IAAtB,EAA4B,MAAMH,CAAlC,EAFqC,CAEA;AACtC,KARqD,CAUtD;AACA;;;AACA,QAAIuF,MAAM,GAAGtF,KAAK,CAACC,MAAN,GAAe,CAA5B,CAZsD,CAatD;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,KAAK,CAACC,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AACrC,UAAIwF,QAAQ,GAAG3F,YAAY,CAAC4F,WAAb,GAA2BzF,CAA3B,CAAf;AACA,UAAIoD,CAAC,GAAG,CAACpD,CAAC,GAAGuF,MAAL,IAAe,EAAvB;AACA,UAAI7B,CAAC,GAAG8B,QAAQ,CAAC9B,CAAT,GAAa2B,OAArB,CAHqC,CAGP;AAC9B;;AACAG,MAAAA,QAAQ,CAACE,QAAT,CAAkB,GAAlB,EAAuB,GAAvB;AACAF,MAAAA,QAAQ,CAACG,WAAT,CAAqBvC,CAArB,EAAwBM,CAAxB;AAED;AACF,GAhbM;AAibP;AACA;AACAqB,EAAAA,oBAnbO,gCAmbcvF,SAnbd,EAmbyBmF,YAnbzB,EAmbuC;AAC5C,QAAIA,YAAY,CAACzE,MAAb,IAAuB,CAA3B,EAA8B;AAC5B;AACD,KAH2C,CAI5C;;;AACA,SAAKkF,YAAL,CAAkBT,YAAlB,EAL4C,CAM5C;;AACA,QAAIlF,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB,CAP4C,CAQ5C;;AACA,QAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;AACA,SAAKgB,yBAAL,CAA+BX,YAA/B,EAA6C8E,YAA7C,EAA2D,GAA3D,EAV4C,CAW5C;AAED,GAhcM;AAkcP;AACAK,EAAAA,WAncO,yBAmcO;AAEZ,QAAIY,SAAS,GAAG,KAAK5H,UAAL,CAAgBkC,MAAhB,GAAyB,CAAzC,CAFY,CAGZ;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhC,UAAL,CAAgBkC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,UAAIwF,QAAQ,GAAG,KAAKxH,UAAL,CAAgBgC,CAAhB,CAAf;AACA,UAAIoD,CAAC,GAAG,CAACpD,CAAC,GAAG4F,SAAL,KAAmB,KAAK3H,UAAL,GAAkB,GAArC,CAAR;AACAuH,MAAAA,QAAQ,CAACG,WAAT,CAAqBvC,CAArB,EAAwB,CAAC,GAAzB;AACD;AAEF,GA7cM;AA+cPyC,EAAAA,iBA/cO,6BA+cWC,SA/cX,EA+csB;AAC3BjH,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAuBgH,SAAnC;;AAEA,QAAIA,SAAS,IAAI,EAAjB,EAAqB;AACnB;AACD;;AAED,YAAQA,SAAR;AACE,WAAKC,UAAU,CAACC,GAAX,CAAeC,IAApB;AACE;;AACF,WAAKF,UAAU,UAAV,CAAkBE,IAAvB;AACE,YAAI3E,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,2BAAX,CAApB;AACD;;AACD;AAPJ;AASD,GA/dM;AAgeP;AACAwE,EAAAA,aAjeO,yBAieOpE,KAjeP,EAiecqE,UAjed,EAie0B;AAC/B,YAAQA,UAAR;AACE,WAAK,YAAL;AACEtH,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;;AACAL,6BAASC,MAAT,CAAgB0H,eAAhB,CAAgCC,UAAU,CAACC,IAA3C;;AACA,aAAK/I,KAAL,CAAW4B,MAAX,GAAoB,KAApB;;AACA,YAAImC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,uCAAX,CAApB;AACD;;AACD;;AACF,WAAK,cAAL;AACE7C,QAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;;AACAL,6BAASC,MAAT,CAAgB0H,eAAhB,CAAgCC,UAAU,CAACE,OAA3C;;AACA,aAAKhJ,KAAL,CAAW4B,MAAX,GAAoB,KAApB;;AACA,YAAImC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,mCAAX,CAApB;AACD;;AACD;;AACF,WAAK,YAAL;AAAoB;AAClBjD,6BAASC,MAAT,CAAgB8H,kBAAhB,CAAmC,EAAnC,EAAuC,IAAvC;;AACA,aAAK/I,cAAL,CAAoB0B,MAApB,GAA6B,KAA7B;AACA;;AACF,WAAK,UAAL;AAAmB;AACjB;AACA,YAAI,KAAKb,gBAAL,CAAsB4B,MAAtB,IAAgC,CAApC,EAAuC;AACrC,eAAKxC,SAAL,CAAe+I,MAAf,GAAwB,OAAxB;AACAxC,UAAAA,UAAU,CAAC,YAAY;AACrB,iBAAKvG,SAAL,CAAe+I,MAAf,GAAwB,EAAxB;AACD,WAFU,CAETrH,IAFS,CAEJ,IAFI,CAAD,EAEI,IAFJ,CAAV;AAGD;;AACDX,6BAASC,MAAT,CAAgBgI,gBAAhB,CAAiC,KAAKpI,gBAAtC,EAAwD,UAAUqI,GAAV,EAAe/H,IAAf,EAAqB;AAE3E,cAAI+H,GAAJ,EAAS;AACP9H,YAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsB6H,GAAlC;AACA9H,YAAAA,OAAO,CAACC,GAAR,CAAY,qBAAqBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAjC;;AACA,gBAAI,KAAKlB,SAAL,CAAe+I,MAAf,IAAyB,EAA7B,EAAiC;AAC/B,mBAAK/I,SAAL,CAAe+I,MAAf,GAAwB7H,IAAI,CAACgI,GAA7B;AACA3C,cAAAA,UAAU,CAAC,YAAY;AACrB,qBAAKvG,SAAL,CAAe+I,MAAf,GAAwB,EAAxB;AACD,eAFU,CAETrH,IAFS,CAEJ,IAFI,CAAD,EAEI,IAFJ,CAAV;AAGD,aARM,CAUP;;;AACA,iBAAK,IAAIY,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKhC,UAAL,CAAgBkC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,kBAAIG,IAAI,GAAG,KAAKnC,UAAL,CAAgBgC,CAAhB,CAAX;AACAG,cAAAA,IAAI,CAACwC,IAAL,CAAU,iBAAV;AACD;;AACD,iBAAKrE,gBAAL,GAAwB,EAAxB;AACD,WAhBD,MAgBO;AACL;AACAO,YAAAA,OAAO,CAACC,GAAR,CAAY,wBAAwBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAApC;AACA,iBAAKnB,cAAL,CAAoB0B,MAApB,GAA6B,KAA7B,CAHK,CAIL;AACA;AACA;;AACA,iBAAK0G,iBAAL,CAAuBjH,IAAI,CAACiI,SAAL,CAAeZ,IAAtC;AACA,iBAAKxB,WAAL,CAAiB7F,IAAI,CAACkI,OAAtB,EAA+B,KAAKxI,gBAApC;AACA,iBAAKA,gBAAL,GAAwB,EAAxB;AAED;AAEF,SA/BuD,CA+BtDc,IA/BsD,CA+BjD,IA/BiD,CAAxD,EARF,CAwCE;;;AACA;;AACF,WAAK,SAAL;AACE;;AACF;AACE;AAlEJ;AAoED;AAtiBM,CAAT","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    gameingUI: cc.Node,\r\n    card_prefab: cc.Prefab,\r\n    robUI: cc.Node,\r\n    bottom_card_pos_node: cc.Node, // 底牌节点\r\n    playingUI_node: cc.Node,\r\n    tipsLabel: cc.Label, //玩家出牌不合法的tips\r\n    fapai: {\r\n      type: cc.AudioClip,\r\n      default: null\r\n    }\r\n    \r\n  },\r\n\r\n  onLoad() {\r\n    //自己牌列表 \r\n    this.cards_nods = []\r\n    this.card_width = 0\r\n    //当前可以抢地主的accountid\r\n    this.rob_player_accountid = 0\r\n    //发牌动画是否结束\r\n    this.fapai_end = false\r\n    //底牌数组\r\n    this.bottom_card = []\r\n    //底牌的json对象数据\r\n    this.bottom_card_data = []\r\n    this.choose_card_data = []\r\n    this.outcar_zone = []\r\n\r\n    this.push_card_tmp = []\r\n\r\n    //监听服务器:通知抢地主消息,显示相应的UI\r\n    myglobal.socket.onCanRobState(function (data) {\r\n      console.log(\"onCanRobState\" + JSON.stringify(data))\r\n      //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\r\n      this.rob_player_accountid = data\r\n      if (data == myglobal.playerData.userId && this.fapai_end == true) {\r\n        this.robUI.active = true\r\n      }\r\n\r\n    }.bind(this))\r\n\r\n    //监听服务器可以出牌消息\r\n    myglobal.socket.onCanChuCard(function (data) {\r\n      console.log(\"onCanChuCard\" + JSON.stringify(data))\r\n      //判断是不是自己能出牌\r\n      if (data == myglobal.playerData.userId) {\r\n        //先清理出牌区域\r\n        this.clearOutZone(myglobal.playerData.userId)\r\n        //先把自己出牌列表置空\r\n        //this.choose_card_data=[]\r\n        //显示可以出牌的UI\r\n        this.playingUI_node.active = true\r\n\r\n      }\r\n    }.bind(this))\r\n\r\n    //监听服务器：其他玩家出牌消息\r\n    myglobal.socket.onOtherPlayerChuCard(function (data) {\r\n      //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\r\n      console.log(\"onOtherPlayerChuCard\" + JSON.stringify(data))\r\n\r\n      var accountid = data.accountid\r\n      var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n      //获取出牌区域节点\r\n      var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n      if (outCard_node == null) {\r\n        return\r\n      }\r\n\r\n      var node_cards = []\r\n      for (var i = 0; i < data.cards.length; i++) {\r\n        var card = cc.instantiate(this.card_prefab)\r\n        card.getComponent(\"card\").showCards(data.cards[i].card_data, myglobal.playerData.userId)\r\n        node_cards.push(card)\r\n      }\r\n      this.appendOtherCardsToOutZone(outCard_node, node_cards, 0)\r\n\r\n\r\n    }.bind(this))\r\n\r\n    //内部事件:显示底牌事件,data是三张底牌数据\r\n    this.node.on(\"show_bottom_card_event\", function (data) {\r\n      console.log(\"----show_bottom_card_event\", +data)\r\n\r\n      this.bottom_card_data = data\r\n\r\n      for (var i = 0; i < data.length; i++) {\r\n        var card = this.bottom_card[i]\r\n        var show_data = data[i]\r\n        var call_data = {\r\n          \"obj\": card,\r\n          \"data\": show_data,\r\n        }\r\n        console.log(\"bottom show_data:\" + JSON.stringify(show_data))\r\n        var run = cc.callFunc(function (target, activedata) {\r\n\r\n          var show_card = activedata.obj\r\n          var show_data = activedata.data\r\n          //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\r\n          show_card.getComponent(\"card\").showCards(show_data)\r\n\r\n        }, this, call_data)\r\n\r\n        card.runAction(cc.sequence(cc.rotateBy(0, 0, 180), cc.rotateBy(0.2, 0, -90), run,\r\n          cc.rotateBy(0.2, 0, -90), cc.scaleBy(1, 1.2)));\r\n\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/start.mp3\"))\r\n        }\r\n      }\r\n\r\n      //this.node.parent.emit(\"change_room_state_event\",defines.gameState.ROOM_PLAYING)\r\n      //如果自己地主，给加上三张底牌\r\n      if (myglobal.playerData.userId == myglobal.playerData.master_accountid) {\r\n        this.scheduleOnce(this.pushThreeCard.bind(this), 0.2)\r\n      }\r\n\r\n\r\n    }.bind(this))\r\n\r\n    //注册监听一个选择牌消息 \r\n    this.node.on(\"choose_card_event\", function (event) {\r\n      console.log(\"choose_card_event:\" + JSON.stringify(event))\r\n      var detail = event\r\n      this.choose_card_data.push(detail)\r\n    }.bind(this))\r\n\r\n    this.node.on(\"unchoose_card_event\", function (event) {\r\n      console.log(\"unchoose_card_event:\" + event)\r\n      var detail = event\r\n      for (var i = 0; i < this.choose_card_data.length; i++) {\r\n        if (this.choose_card_data[i].cardid == detail) {\r\n          this.choose_card_data.splice(i, 1)\r\n        }\r\n      }\r\n    }.bind(this))\r\n\r\n  },\r\n\r\n  start() {\r\n    //监听服务器:下发牌消息\r\n    window.$socket.on('pushcard_notify', this.pushCardNotify, this)\r\n  },\r\n  onDestroy() {\r\n    window.$socket.remove('pushcard_notify', this)\r\n  },\r\n  pushCardNotify(data) {\r\n    console.log(\"onPushCards\" + JSON.stringify(data))\r\n    this.card_data = data\r\n    this.cur_index_card = data.length - 1\r\n    this.pushCard(data)\r\n    //左边移动定时器\r\n    this.scheduleOnce(this._runactive_pushcard.bind(this), 0.3)\r\n    this.node.parent.emit(\"pushcard_other_event\")\r\n\r\n  },\r\n  //处理发牌的效果\r\n  _runactive_pushcard() {\r\n    if (this.cur_index_card < 0) {\r\n      console.log(\"pushcard end\")\r\n      //发牌动画完成，显示抢地主按钮\r\n      //this.robUI.active = true\r\n      this.fapai_end = true\r\n      if (this.rob_player_accountid == myglobal.playerData.userId) {\r\n        this.robUI.active = true\r\n      }\r\n\r\n      if (isopen_sound) {\r\n        //console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n        cc.audioEngine.stop(this.fapai_audioID)\r\n      }\r\n\r\n\r\n      //通知gamescene节点，倒计时\r\n      var sendevent = this.rob_player_accountid\r\n      this.node.parent.emit(\"canrob_event\", sendevent)\r\n\r\n      return\r\n    }\r\n\r\n    //原有逻辑  \r\n    // var move_node = this.cards_nods[this.cur_index_card]\r\n    // move_node.active = true\r\n    // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\r\n    // var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n    // move_node.runAction(action)\r\n    // this.cur_index_card--\r\n    // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n\r\n\r\n    var move_node = this.cards_nods[this.cards_nods.length - this.cur_index_card - 1]\r\n    move_node.active = true\r\n    this.push_card_tmp.push(move_node)\r\n    this.fapai_audioID = common.audio.PlayEffect(this.fapai)\r\n    for (var i = 0; i < this.push_card_tmp.length - 1; i++) {\r\n      var move_node = this.push_card_tmp[i]\r\n      var newx = move_node.x - (this.card_width * 0.4)\r\n      var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n      move_node.runAction(action)\r\n    }\r\n\r\n    this.cur_index_card--\r\n    this.scheduleOnce(this._runactive_pushcard.bind(this), 0.3)\r\n  },\r\n\r\n  //对牌排序\r\n  sortCard() {\r\n    this.cards_nods.sort(function (x, y) {\r\n      var a = x.getComponent(\"card\").card_data;\r\n      var b = y.getComponent(\"card\").card_data;\r\n\r\n      if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n        return b.value - a.value;\r\n      }\r\n      if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n        return -1;\r\n      }\r\n      if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return 1;\r\n      }\r\n      if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return b.king - a.king;\r\n      }\r\n    })\r\n    //var x = this.cards_nods[0].x;\r\n    //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\r\n    //所以做1000毫秒的延时\r\n    var timeout = 1000\r\n    setTimeout(function () {\r\n      //var x = -417.6 \r\n      var x = this.cards_nods[0].x;\r\n      console.log(\"sort x:\" + x)\r\n      for (let i = 0; i < this.cards_nods.length; i++) {\r\n        var card = this.cards_nods[i];\r\n        card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\r\n        card.x = x + card.width * 0.4 * i;\r\n      }\r\n    }.bind(this), timeout);\r\n\r\n\r\n  },\r\n\r\n\r\n  pushCard(data) {\r\n    if (data) {\r\n      data.sort(function (a, b) {\r\n        if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n          return b.value - a.value;\r\n        }\r\n        if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n          return -1;\r\n        }\r\n        if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n          return 1;\r\n        }\r\n        if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n          return b.king - a.king;\r\n        }\r\n      });\r\n    }\r\n    //创建card预制体\r\n    this.cards_nods = []\r\n    for (var i = 0; i < 17; i++) {\r\n\r\n      var card = cc.instantiate(this.card_prefab)\r\n      card.scale = 0.8\r\n      card.parent = this.node.parent\r\n      card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\r\n      //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\r\n      card.y = -250\r\n      card.active = false\r\n\r\n      card.getComponent(\"card\").showCards(data[i], myglobal.playerData.userId)\r\n      //存储牌的信息,用于后面发牌效果\r\n      this.cards_nods.push(card)\r\n      this.card_width = card.width\r\n    }\r\n\r\n    //创建3张底牌\r\n    this.bottom_card = []\r\n    for (var i = 0; i < 3; i++) {\r\n      var di_card = cc.instantiate(this.card_prefab)\r\n      di_card.scale = 0.4\r\n      di_card.position = this.bottom_card_pos_node.position\r\n      //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\r\n      //0,和2两张牌左右移动windth*0.4\r\n      if (i == 0) {\r\n        di_card.x = di_card.x - di_card.width * 0.5\r\n      } else if (i == 2) {\r\n        di_card.x = di_card.x + di_card.width * 0.5\r\n      }\r\n\r\n\r\n      //di_card.x = di_card.width-i*di_card.width-20\r\n      //di_card.y=60\r\n      di_card.parent = this.node.parent\r\n      //存储在容器里\r\n      this.bottom_card.push(di_card)\r\n    }\r\n\r\n  },\r\n\r\n  //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\r\n  schedulePushThreeCard() {\r\n    for (var i = 0; i < this.cards_nods.length; i++) {\r\n      var card = this.cards_nods[i]\r\n      if (card.y == -230) {\r\n        card.y = -250\r\n      }\r\n    }\r\n  },\r\n  //给地主发三张排，并显示在原有牌的后面\r\n  pushThreeCard() {\r\n    //每张牌的其实位置 \r\n    var last_card_x = this.cards_nods[this.cards_nods.length - 1].x\r\n    for (var i = 0; i < this.bottom_card_data.length; i++) {\r\n      var card = cc.instantiate(this.card_prefab)\r\n      card.scale = 0.8\r\n      card.parent = this.node.parent\r\n\r\n      card.x = last_card_x + ((i + 1) * this.card_width * 0.4)\r\n      card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\r\n\r\n      //console.log(\"pushThreeCard x:\"+card.x)\r\n      card.getComponent(\"card\").showCards(this.bottom_card_data[i], myglobal.playerData.userId)\r\n      card.active = true\r\n      this.cards_nods.push(card)\r\n    }\r\n\r\n    this.sortCard()\r\n    //设置一个定时器，在2s后，修改y坐标为-250\r\n    this.scheduleOnce(this.schedulePushThreeCard.bind(this), 2)\r\n\r\n  },\r\n\r\n  destoryCard(accountid, choose_card) {\r\n    if (choose_card.length == 0) {\r\n      return\r\n    }\r\n\r\n    /*出牌逻辑\r\n      1. 将选中的牌 从父节点中移除\r\n      2. 从this.cards_nods 数组中，删除 选中的牌 \r\n      3. 将 “选中的牌” 添加到出牌区域\r\n          3.1 清空出牌区域\r\n          3.2 添加子节点\r\n          3.3 设置scale\r\n          3.4 设置position\r\n      4.  重新设置手中的牌的位置  this.updateCards();\r\n    */\r\n    //1/2步骤删除自己手上的card节点 \r\n    var destroy_card = []\r\n    for (var i = 0; i < choose_card.length; i++) {\r\n      for (var j = 0; j < this.cards_nods.length; j++) {\r\n        var card_id = this.cards_nods[j].getComponent(\"card\").card_id\r\n        if (card_id == choose_card[i].cardid) {\r\n          console.log(\"destroy card id:\" + card_id)\r\n          //this.cards_nods[j].destroy()\r\n          this.cards_nods[j].removeFromParent(true);\r\n          destroy_card.push(this.cards_nods[j])\r\n          this.cards_nods.splice(j, 1)\r\n        }\r\n      }\r\n    }\r\n\r\n    this.appendCardsToOutZone(accountid, destroy_card)\r\n    this.updateCards()\r\n\r\n  },\r\n\r\n  //清除显示出牌节点全部子节点(就是把出牌的清空)\r\n  clearOutZone(accountid) {\r\n    var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n    var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n    var children = outCard_node.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var card = children[i];\r\n      card.destroy()\r\n    }\r\n    outCard_node.removeAllChildren(true);\r\n  },\r\n  //对出的牌做排序\r\n  pushCardSort(cards) {\r\n    if (cards.length == 1) {\r\n      return\r\n    }\r\n    cards.sort(function (x, y) {\r\n      var a = x.getComponent(\"card\").card_data;\r\n      var b = y.getComponent(\"card\").card_data;\r\n\r\n      if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n        return b.value - a.value;\r\n      }\r\n      if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n        return -1;\r\n      }\r\n      if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return 1;\r\n      }\r\n      if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return b.king - a.king;\r\n      }\r\n    })\r\n  },\r\n\r\n  appendOtherCardsToOutZone(outCard_node, cards, yoffset) {\r\n    outCard_node.removeAllChildren(true);\r\n\r\n    //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\r\n    //添加新的子节点\r\n    for (var i = 0; i < cards.length; i++) {\r\n      var card = cards[i];\r\n      outCard_node.addChild(card, 100 + i) //第二个参数是zorder,保证牌不能被遮住\r\n    }\r\n\r\n    //对出牌进行排序\r\n    //设置出牌节点的坐标\r\n    var zPoint = cards.length / 2;\r\n    //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\r\n    for (var i = 0; i < cards.length; i++) {\r\n      var cardNode = outCard_node.getChildren()[i]\r\n      var x = (i - zPoint) * 30;\r\n      var y = cardNode.y + yoffset; //因为每个节点需要的Y不一样，做参数传入\r\n      //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\r\n      cardNode.setScale(0.5, 0.5);\r\n      cardNode.setPosition(x, y);\r\n\r\n    }\r\n  },\r\n  //将 “选中的牌” 添加到出牌区域\r\n  //destroy_card是玩家本次出的牌\r\n  appendCardsToOutZone(accountid, destroy_card) {\r\n    if (destroy_card.length == 0) {\r\n      return\r\n    }\r\n    //先给本次出的牌做一个排序\r\n    this.pushCardSort(destroy_card)\r\n    //console.log(\"appendCardsToOutZone\")\r\n    var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n    //获取出牌区域节点\r\n    var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n    this.appendOtherCardsToOutZone(outCard_node, destroy_card, 360)\r\n    //sconsole.log(\"OutZone:\"+outCard_node.name)\r\n\r\n  },\r\n\r\n  //重新排序手上的牌,并移动\r\n  updateCards() {\r\n\r\n    var zeroPoint = this.cards_nods.length / 2;\r\n    //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\r\n    for (var i = 0; i < this.cards_nods.length; i++) {\r\n      var cardNode = this.cards_nods[i]\r\n      var x = (i - zeroPoint) * (this.card_width * 0.4);\r\n      cardNode.setPosition(x, -250);\r\n    }\r\n\r\n  },\r\n\r\n  playPushCardSound(card_name) {\r\n    console.log(\"playPushCardSound:\" + card_name)\r\n\r\n    if (card_name == \"\") {\r\n      return\r\n    }\r\n\r\n    switch (card_name) {\r\n      case CardsValue.one.name:\r\n        break\r\n      case CardsValue.double.name:\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\"))\r\n        }\r\n        break\r\n    }\r\n  },\r\n  // update (dt) {},\r\n  onButtonClick(event, customData) {\r\n    switch (customData) {\r\n      case \"btn_qiandz\":\r\n        console.log(\"btn_qiandz\")\r\n        myglobal.socket.requestRobState(qian_state.qian)\r\n        this.robUI.active = false\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\"))\r\n        }\r\n        break\r\n      case \"btn_buqiandz\":\r\n        console.log(\"btn_buqiandz\")\r\n        myglobal.socket.requestRobState(qian_state.buqiang)\r\n        this.robUI.active = false\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\"))\r\n        }\r\n        break\r\n      case \"nopushcard\":  //不出牌\r\n        myglobal.socket.request_buchu_card([], null)\r\n        this.playingUI_node.active = false\r\n        break\r\n      case \"pushcard\":   //出牌\r\n        //先获取本次出牌数据\r\n        if (this.choose_card_data.length == 0) {\r\n          this.tipsLabel.string = \"请选择牌!\"\r\n          setTimeout(function () {\r\n            this.tipsLabel.string = \"\"\r\n          }.bind(this), 2000);\r\n        }\r\n        myglobal.socket.request_chu_card(this.choose_card_data, function (err, data) {\r\n\r\n          if (err) {\r\n            console.log(\"request_chu_card:\" + err)\r\n            console.log(\"request_chu_card\" + JSON.stringify(data))\r\n            if (this.tipsLabel.string == \"\") {\r\n              this.tipsLabel.string = data.msg\r\n              setTimeout(function () {\r\n                this.tipsLabel.string = \"\"\r\n              }.bind(this), 2000);\r\n            }\r\n\r\n            //出牌失败，把选择的牌归位\r\n            for (var i = 0; i < this.cards_nods.length; i++) {\r\n              var card = this.cards_nods[i]\r\n              card.emit(\"reset_card_flag\")\r\n            }\r\n            this.choose_card_data = []\r\n          } else {\r\n            //出牌成功\r\n            console.log(\"resp_chu_card data:\" + JSON.stringify(data))\r\n            this.playingUI_node.active = false\r\n            //播放出牌的声音\r\n            //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\r\n            //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\r\n            this.playPushCardSound(data.cardvalue.name)\r\n            this.destoryCard(data.account, this.choose_card_data)\r\n            this.choose_card_data = []\r\n\r\n          }\r\n\r\n        }.bind(this))\r\n        //this.playingUI_node.active = false\r\n        break\r\n      case \"tipcard\":\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n\r\n});\r\n"]}