{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\loginscene/assets\\scripts\\loginscene\\loginScene.js"],"names":["cc","Class","Component","properties","wait_node","Node","onLoad","director","preloadScene","start","onButtonCilck","event","customData","console","log","myglobal","socket","request_wxLogin","uniqueID","playerData","userName","avatarUrl","err","result","JSON","stringify","gobal_count","goldcount","loadScene","bind","active","count","Math","floor","random","userId","sys","localStorage","setItem"],"mappings":";;;;;;AAAA;;;;AACAA,EAAE,CAACC,KAAH,CAAS;AACP,aAASD,EAAE,CAACE,SADL;AAGPC,EAAAA,UAAU,EAAE;AACVC,IAAAA,SAAS,EAAEJ,EAAE,CAACK;AADJ,GAHL;AAOP;AAEAC,EAAAA,MATO,oBASE;AACPN,IAAAA,EAAE,CAACO,QAAH,CAAYC,YAAZ,CAAyB,WAAzB;AACD,GAXM;AAaPC,EAAAA,KAbO,mBAaC,CAAE,CAbH;AAcPC,EAAAA,aAdO,yBAcOC,KAdP,EAccC,UAdd,EAc0B;AAC/B,YAAQA,UAAR;AACE,WAAK,UAAL;AACEC,QAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ,EADF,CAGE;;AAEAC,6BAASC,MAAT,CAAgBC,eAAhB,CAAgC;AAC9BC,UAAAA,QAAQ,EAAEH,qBAASI,UAAT,CAAoBD,QADA;AAE9B;AACAE,UAAAA,QAAQ,EAAEL,qBAASI,UAAT,CAAoBC,QAHA;AAI9BC,UAAAA,SAAS,EAAEN,qBAASI,UAAT,CAAoBE;AAJD,SAAhC,EAKG,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACxB;AACA;AACA;AACA,cAAID,GAAG,IAAI,CAAX,EAAc;AACZT,YAAAA,OAAO,CAACC,GAAR,CAAY,SAASQ,GAArB;AACA;AACD;;AAEDT,UAAAA,OAAO,CAACC,GAAR,CAAY,iBAAiBU,IAAI,CAACC,SAAL,CAAeF,MAAf,CAA7B;AACAR,+BAASI,UAAT,CAAoBO,WAApB,GAAkCH,MAAM,CAACI,SAAzC;AACA3B,UAAAA,EAAE,CAACO,QAAH,CAAYqB,SAAZ,CAAsB,WAAtB;AACD,SAZE,CAYDC,IAZC,CAYI,IAZJ,CALH;;AAkBA;;AACF,WAAK,aAAL;AACE,aAAKzB,SAAL,CAAe0B,MAAf,GAAwB,IAAxB;AACA,YAAMC,KAAK,GAAGC,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,MAAL,KAAgB,MAA3B,CAAd;AACA,YAAMd,QAAQ,mBAAYW,KAAZ,CAAd;AACAhB,6BAASI,UAAT,CAAoBgB,MAApB,aAAgCJ,KAAhC;AACAhB,6BAASI,UAAT,CAAoBC,QAApB,GAA+BA,QAA/B;AACApB,QAAAA,EAAE,CAACoC,GAAH,CAAOC,YAAP,CAAoBC,OAApB,CAA4B,UAA5B,EAAwCd,IAAI,CAACC,SAAL,CAAeV,qBAASI,UAAxB,CAAxC;AACAnB,QAAAA,EAAE,CAACO,QAAH,CAAYqB,SAAZ,CAAsB,WAAtB;;AACF;AACE;AAlCJ;AAoCD,GAnDM,CAoDP;;AApDO,CAAT","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\loginscene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    wait_node: cc.Node\r\n  },\r\n\r\n  // LIFE-CYCLE CALLBACKS:\r\n\r\n  onLoad() {\r\n    cc.director.preloadScene(\"hallScene\")\r\n  },\r\n\r\n  start() {},\r\n  onButtonCilck(event, customData) {\r\n    switch (customData) {\r\n      case \"wx_login\":\r\n        console.log(\"wx_login request\")\r\n\r\n        //this.wait_node.active = true\r\n\r\n        myglobal.socket.request_wxLogin({\r\n          uniqueID: myglobal.playerData.uniqueID,\r\n          // userId: myglobal.playerData.userId,\r\n          userName: myglobal.playerData.userName,\r\n          avatarUrl: myglobal.playerData.avatarUrl,\r\n        }, function (err, result) {\r\n          //请求返回\r\n          //先隐藏等待UI\r\n          //this.wait_node.active = false\r\n          if (err != 0) {\r\n            console.log(\"err:\" + err)\r\n            return\r\n          }\r\n\r\n          console.log(\"login sucess\" + JSON.stringify(result))\r\n          myglobal.playerData.gobal_count = result.goldcount\r\n          cc.director.loadScene(\"hallScene\")\r\n        }.bind(this))\r\n        break\r\n      case 'guest_login':\r\n        this.wait_node.active = true\r\n        const count = Math.floor(Math.random() * 100000)\r\n        const userName = `guest_${count}`\r\n        myglobal.playerData.userId = `${count}`\r\n        myglobal.playerData.userName = userName\r\n        cc.sys.localStorage.setItem('userData', JSON.stringify(myglobal.playerData))\r\n        cc.director.loadScene(\"hallScene\")\r\n      default:\r\n        break\r\n    }\r\n  }\r\n  // update (dt) {},\r\n\r\n\r\n});\r\n"]}