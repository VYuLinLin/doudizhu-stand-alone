{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\gameScene/assets\\scripts\\gameScene\\gameingUI.js"],"names":["cc","Class","Component","properties","gameingUI","Node","card_prefab","Prefab","robUI","bottom_card_pos_node","playingUI_node","tipsLabel","Label","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","myglobal","socket","onPushCards","data","console","log","JSON","stringify","card_data","cur_index_card","length","pushCard","isopen_sound","fapai_audioID","scheduleOnce","_runactive_pushcard","bind","node","parent","emit","onCanRobState","playerData","accountID","active","onCanChuCard","clearOutZone","onOtherPlayerChuCard","accountid","gameScene_script","getComponent","outCard_node","getUserOutCardPosByAccount","node_cards","i","cards","card","instantiate","showCards","push","appendOtherCardsToOutZone","on","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","audioEngine","play","url","raw","master_accountid","pushThreeCard","event","detail","cardid","splice","start","stop","sendevent","move_node","newx","x","action","moveTo","v2","sortCard","sort","y","a","b","hasOwnProperty","value","king","timeout","setTimeout","zIndex","width","scale","di_card","position","schedulePushThreeCard","last_card_x","destoryCard","choose_card","destroy_card","j","card_id","removeFromParent","appendCardsToOutZone","updateCards","children","destroy","removeAllChildren","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","playPushCardSound","card_name","CardsValue","one","name","onButtonClick","customData","requestRobState","qian_state","qian","buqiang","request_buchu_card","string","request_chu_card","err","msg","cardvalue","account"],"mappings":"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","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        gameingUI: cc.Node,\r\n        card_prefab:cc.Prefab,\r\n        robUI:cc.Node,\r\n        bottom_card_pos_node:cc.Node,\r\n        playingUI_node:cc.Node,\r\n        tipsLabel:cc.Label, //玩家出牌不合法的tips\r\n    \r\n    },\r\n\r\n    onLoad () {\r\n        //自己牌列表 \r\n        this.cards_nods = []\r\n        this.card_width = 0\r\n        //当前可以抢地主的accountid\r\n        this.rob_player_accountid = 0\r\n        //发牌动画是否结束\r\n        this.fapai_end = false\r\n        //底牌数组\r\n        this.bottom_card = []\r\n        //底牌的json对象数据\r\n        this.bottom_card_data=[]\r\n        this.choose_card_data=[]\r\n        this.outcar_zone = []\r\n\r\n        this.push_card_tmp = []\r\n        //监听服务器:下发牌消息\r\n        myglobal.socket.onPushCards(function(data){\r\n            console.log(\"onPushCards\"+JSON.stringify(data))\r\n            this.card_data = data\r\n            this.cur_index_card = data.length - 1\r\n            this.pushCard(data)\r\n            if(isopen_sound){\r\n                //循环播放发牌音效\r\n               // this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"),true)\r\n                console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n            }\r\n             //左边移动定时器\r\n            this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n            this.node.parent.emit(\"pushcard_other_event\")\r\n           \r\n        }.bind(this))\r\n\r\n        //监听服务器:通知抢地主消息,显示相应的UI\r\n        myglobal.socket.onCanRobState(function(data){\r\n            console.log(\"onCanRobState\"+JSON.stringify(data))\r\n            //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\r\n            this.rob_player_accountid = data\r\n            if(data==myglobal.playerData.accountID && this.fapai_end==true){\r\n                this.robUI.active = true\r\n            }\r\n          \r\n        }.bind(this))\r\n        \r\n        //监听服务器可以出牌消息\r\n        myglobal.socket.onCanChuCard(function(data){\r\n            console.log(\"onCanRobState\"+JSON.stringify(data))\r\n            //判断是不是自己能出牌\r\n            if(data==myglobal.playerData.accountID){\r\n                //先清理出牌区域\r\n                this.clearOutZone(myglobal.playerData.accountID)\r\n                //先把自己出牌列表置空\r\n                //this.choose_card_data=[]\r\n                //显示可以出牌的UI\r\n                this.playingUI_node.active = true\r\n\r\n            }\r\n        }.bind(this))\r\n\r\n        //监听服务器：其他玩家出牌消息\r\n        myglobal.socket.onOtherPlayerChuCard(function(data){\r\n            //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\r\n            console.log(\"onOtherPlayerChuCard\"+JSON.stringify(data))\r\n\r\n            var accountid = data.accountid\r\n            var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n            //获取出牌区域节点\r\n            var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n            if(outCard_node==null){\r\n                return\r\n            }\r\n\r\n            var node_cards = []\r\n            for(var i=0;i<data.cards.length;i++){\r\n                var card = cc.instantiate(this.card_prefab)\r\n                card.getComponent(\"card\").showCards(data.cards[i].card_data,myglobal.playerData.accountID)\r\n                node_cards.push(card)\r\n            }\r\n            this.appendOtherCardsToOutZone(outCard_node,node_cards,0)\r\n\r\n            \r\n        }.bind(this))\r\n\r\n        //内部事件:显示底牌事件,data是三张底牌数据\r\n        this.node.on(\"show_bottom_card_event\",function(data){\r\n            console.log(\"----show_bottom_card_event\",+data)\r\n          \r\n            this.bottom_card_data = data\r\n            \r\n            for(var i=0;i<data.length;i++){\r\n                var card = this.bottom_card[i]\r\n                var show_data = data[i]\r\n                var call_data = {\r\n                    \"obj\":card,\r\n                    \"data\":show_data,\r\n                }\r\n                console.log(\"bottom show_data:\"+JSON.stringify(show_data))\r\n                var run =  cc.callFunc(function(target,activedata){\r\n                   \r\n                    var show_card = activedata.obj\r\n                    var show_data = activedata.data\r\n                    //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\r\n                    show_card.getComponent(\"card\").showCards(show_data)\r\n                   \r\n                },this,call_data)\r\n\r\n                card.runAction(cc.sequence(cc.rotateBy(0,0,180),cc.rotateBy(0.2,0,-90), run,\r\n                cc.rotateBy(0.2,0,-90),cc.scaleBy(1, 1.2)));\r\n               \r\n                if(isopen_sound){\r\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/start.mp3\")) \r\n                 }\r\n            }\r\n\r\n            //this.node.parent.emit(\"change_room_state_event\",RoomState.ROOM_PLAYING)\r\n            //如果自己地主，给加上三张底牌\r\n            if(myglobal.playerData.accountID==myglobal.playerData.master_accountid){\r\n                this.scheduleOnce(this.pushThreeCard.bind(this),0.2)\r\n            }\r\n            \r\n              \r\n        }.bind(this))\r\n\r\n        //注册监听一个选择牌消息 \r\n        this.node.on(\"choose_card_event\",function(event){\r\n            console.log(\"choose_card_event:\"+JSON.stringify(event))\r\n            var detail = event\r\n            this.choose_card_data.push(detail)\r\n        }.bind(this))\r\n\r\n        this.node.on(\"unchoose_card_event\",function(event){\r\n            console.log(\"unchoose_card_event:\"+ event)\r\n            var detail = event\r\n            for(var i=0;i<this.choose_card_data.length;i++){\r\n                if(this.choose_card_data[i].cardid==detail){\r\n                    this.choose_card_data.splice(i,1)\r\n                }\r\n            }\r\n        }.bind(this))\r\n\r\n    },\r\n\r\n    start () {\r\n     \r\n    },\r\n\r\n    //处理发牌的效果\r\n    _runactive_pushcard(){\r\n        //console.log(\"_runactive_pushcard:\"+this.cur_index_card)\r\n        if(this.cur_index_card < 0){\r\n            console.log(\"pushcard end\")\r\n            //发牌动画完成，显示抢地主按钮\r\n            //this.robUI.active = true\r\n            this.fapai_end = true\r\n            if(this.rob_player_accountid==myglobal.playerData.accountID){\r\n                this.robUI.active = true\r\n            }\r\n\r\n            if(isopen_sound){\r\n                //console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n                cc.audioEngine.stop(this.fapai_audioID)\r\n            }\r\n           \r\n\r\n              //通知gamescene节点，倒计时\r\n            var sendevent = this.rob_player_accountid\r\n            this.node.parent.emit(\"canrob_event\",sendevent)\r\n\r\n            return\r\n        }\r\n\r\n        //原有逻辑  \r\n        // var move_node = this.cards_nods[this.cur_index_card]\r\n        // move_node.active = true\r\n        // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\r\n        // var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n        // move_node.runAction(action)\r\n        // this.cur_index_card--\r\n        // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n\r\n        \r\n        var move_node = this.cards_nods[this.cards_nods.length-this.cur_index_card-1]\r\n        move_node.active = true\r\n        this.push_card_tmp.push(move_node)\r\n        this.fapai_audioID = cc.audioEngine.play(cc.url.raw(\"resources/sound/fapai1.mp3\"))\r\n        for(var i=0;i<this.push_card_tmp.length-1;i++){\r\n                var move_node = this.push_card_tmp[i]\r\n                var newx = move_node.x - (this.card_width * 0.4)\r\n                var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n                move_node.runAction(action)\r\n        }\r\n        \r\n        this.cur_index_card--\r\n        this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n    },\r\n \r\n    //对牌排序\r\n    sortCard(){\r\n        this.cards_nods.sort(function(x,y){\r\n            var a = x.getComponent(\"card\").card_data;\r\n            var b = y.getComponent(\"card\").card_data;\r\n\r\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                return  b.value-a.value;\r\n            }\r\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                return -1;\r\n            }\r\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return 1;\r\n            }\r\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return  b.king-a.king;\r\n            }\r\n        })\r\n        //var x = this.cards_nods[0].x;\r\n        //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\r\n        //所以做1000毫秒的延时\r\n        var timeout = 1000\r\n        setTimeout(function(){\r\n            //var x = -417.6 \r\n            var x = this.cards_nods[0].x;\r\n            console.log(\"sort x:\"+ x)\r\n            for (let i = 0; i < this.cards_nods.length; i++) {\r\n                var card = this.cards_nods[i];\r\n                card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\r\n                card.x = x + card.width * 0.4 * i;\r\n            }\r\n        }.bind(this), timeout);\r\n        \r\n       \r\n    },\r\n\r\n  \r\n    pushCard(data){\r\n    if (data) {\r\n            data.sort(function (a, b) {\r\n                if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                    return b.value - a.value;\r\n                }\r\n                if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                    return -1;\r\n                }\r\n                if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                    return 1;\r\n                }\r\n                if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                    return b.king - a.king;\r\n                }\r\n            });\r\n        }\r\n      //创建card预制体\r\n      this.cards_nods = []\r\n      for(var i=0;i<17;i++){\r\n        \r\n        var card = cc.instantiate(this.card_prefab)\r\n        card.scale=0.8\r\n        card.parent = this.node.parent\r\n        //card.x = card.width * 0.4 * (17 - 1) * (-0.5) + card.width * 0.4 * 0;\r\n        card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\r\n        //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\r\n        card.y = -250\r\n        card.active = false\r\n\r\n        card.getComponent(\"card\").showCards(data[i],myglobal.playerData.accountID)\r\n        //存储牌的信息,用于后面发牌效果\r\n        this.cards_nods.push(card)\r\n        this.card_width = card.width\r\n      }\r\n      \r\n      //创建3张底牌\r\n      this.bottom_card = []\r\n      for(var i=0;i<3;i++){\r\n        var di_card = cc.instantiate(this.card_prefab)\r\n        di_card.scale=0.4\r\n        di_card.position = this.bottom_card_pos_node.position \r\n        //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\r\n        //0,和2两张牌左右移动windth*0.4\r\n        if(i==0){\r\n            \r\n            di_card.x = di_card.x - di_card.width*0.4\r\n        }else if(i==2){\r\n            di_card.x = di_card.x + di_card.width*0.4\r\n        }\r\n        \r\n\r\n        //di_card.x = di_card.width-i*di_card.width-20\r\n        //di_card.y=60\r\n        di_card.parent = this.node.parent\r\n        //存储在容器里\r\n        this.bottom_card.push(di_card)\r\n      }\r\n\r\n    },\r\n\r\n    //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\r\n    schedulePushThreeCard(){\r\n        for(var i=0;i<this.cards_nods.length;i++){\r\n            var card = this.cards_nods[i]\r\n            if(card.y==-230){\r\n                card.y = -250\r\n            }\r\n        }\r\n    },\r\n    //给地主发三张排，并显示在原有牌的后面\r\n    pushThreeCard(){\r\n        //每张牌的其实位置 \r\n        var last_card_x =  this.cards_nods[this.cards_nods.length-1].x\r\n        for(var i=0;i<this.bottom_card_data.length;i++){\r\n            var card = cc.instantiate(this.card_prefab)\r\n            card.scale=0.8\r\n            card.parent = this.node.parent\r\n          \r\n            card.x = last_card_x + ((i+1)*this.card_width * 0.4)\r\n            card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\r\n           \r\n            //console.log(\"pushThreeCard x:\"+card.x)\r\n            card.getComponent(\"card\").showCards(this.bottom_card_data[i],myglobal.playerData.accountID)\r\n            card.active = true\r\n            this.cards_nods.push(card)\r\n        }\r\n\r\n        this.sortCard()\r\n        //设置一个定时器，在2s后，修改y坐标为-250\r\n        this.scheduleOnce(this.schedulePushThreeCard.bind(this),2)\r\n\r\n    },\r\n\r\n    destoryCard(accountid,choose_card){\r\n        if(choose_card.length==0){\r\n            return\r\n        }\r\n\r\n        /*出牌逻辑\r\n          1. 将选中的牌 从父节点中移除\r\n          2. 从this.cards_nods 数组中，删除 选中的牌 \r\n          3. 将 “选中的牌” 添加到出牌区域\r\n              3.1 清空出牌区域\r\n              3.2 添加子节点\r\n              3.3 设置scale\r\n              3.4 设置position\r\n          4.  重新设置手中的牌的位置  this.updateCards();\r\n        */\r\n        //1/2步骤删除自己手上的card节点 \r\n        var destroy_card = []\r\n        for(var i=0;i<choose_card.length;i++){\r\n            for(var j=0;j<this.cards_nods.length;j++){\r\n                var card_id = this.cards_nods[j].getComponent(\"card\").card_id\r\n                if(card_id==choose_card[i].cardid){\r\n                    console.log(\"destroy card id:\"+card_id)\r\n                    //this.cards_nods[j].destroy()\r\n                    this.cards_nods[j].removeFromParent(true);\r\n                    destroy_card.push(this.cards_nods[j])\r\n                    this.cards_nods.splice(j,1)\r\n                }\r\n            }\r\n        }\r\n\r\n        this.appendCardsToOutZone(accountid,destroy_card)\r\n        this.updateCards()\r\n\r\n    },\r\n\r\n    //清除显示出牌节点全部子节点(就是把出牌的清空)\r\n    clearOutZone(accountid){\r\n        var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n        var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n        var children = outCard_node.children;\r\n        for(var i=0;i<children.length;i++){\r\n            var card = children[i]; \r\n            card.destroy()\r\n        }\r\n        outCard_node.removeAllChildren(true);\r\n    },\r\n    //对出的牌做排序\r\n    pushCardSort(cards){\r\n        if(cards.length==1){\r\n            return\r\n        }\r\n        cards.sort(function(x,y){\r\n            var a = x.getComponent(\"card\").card_data;\r\n            var b = y.getComponent(\"card\").card_data;\r\n\r\n            if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n                return b.value - a.value;\r\n            }\r\n            if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n                return -1;\r\n            }\r\n            if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return 1;\r\n            }\r\n            if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n                return b.king - a.king;\r\n            }\r\n        })\r\n    },\r\n\r\n    appendOtherCardsToOutZone(outCard_node,cards,yoffset){\r\n       outCard_node.removeAllChildren(true);\r\n\r\n       //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\r\n       //添加新的子节点\r\n       for(var i=0;i<cards.length;i++){\r\n           var card = cards[i]; \r\n           outCard_node.addChild(card,100+i) //第二个参数是zorder,保证牌不能被遮住\r\n       }\r\n\r\n       //对出牌进行排序\r\n       //设置出牌节点的坐标\r\n       var zPoint = cards.length / 2;\r\n       //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\r\n       for(var i=0;i<cards.length;i++){\r\n        var cardNode = outCard_node.getChildren()[i]\r\n        var x = (i - zPoint) * 30;\r\n        var y = cardNode.y+yoffset; //因为每个节点需要的Y不一样，做参数传入\r\n        //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\r\n        cardNode.setScale(0.5, 0.5);                   \r\n        cardNode.setPosition(x,y);                     \r\n\r\n       }\r\n    },\r\n    //将 “选中的牌” 添加到出牌区域\r\n    //destroy_card是玩家本次出的牌\r\n    appendCardsToOutZone(accountid,destroy_card){\r\n        if(destroy_card.length==0){\r\n            return\r\n        }\r\n        //先给本次出的牌做一个排序\r\n       this.pushCardSort(destroy_card)\r\n       //console.log(\"appendCardsToOutZone\")\r\n       var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n       //获取出牌区域节点\r\n       var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n       this.appendOtherCardsToOutZone(outCard_node,destroy_card,360)\r\n       //sconsole.log(\"OutZone:\"+outCard_node.name)\r\n\r\n    },\r\n\r\n    //重新排序手上的牌,并移动\r\n    updateCards(){\r\n    \r\n        var zeroPoint = this.cards_nods.length / 2;\r\n        //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\r\n        for(var i=0;i<this.cards_nods.length;i++){\r\n            var cardNode = this.cards_nods[i]\r\n            var x = (i - zeroPoint)*(this.card_width * 0.4);\r\n            cardNode.setPosition(x, -250);  \r\n        }\r\n\r\n    },\r\n    \r\n    playPushCardSound(card_name){\r\n        console.log(\"playPushCardSound:\"+card_name)\r\n        \r\n        if(card_name==\"\"){\r\n            return\r\n        }\r\n\r\n        switch(card_name){\r\n            case CardsValue.one.name:\r\n                break\r\n            case CardsValue.double.name:\r\n                    if(isopen_sound){\r\n                        cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\")) \r\n                     }\r\n                break  \r\n        }\r\n    },\r\n    // update (dt) {},\r\n    onButtonClick(event,customData){\r\n        switch(customData){\r\n            case \"btn_qiandz\":\r\n                console.log(\"btn_qiandz\")\r\n                myglobal.socket.requestRobState(qian_state.qian)\r\n                this.robUI.active = false\r\n                if(isopen_sound){\r\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\")) \r\n                 }\r\n                break\r\n            case \"btn_buqiandz\":\r\n                console.log(\"btn_buqiandz\")\r\n                myglobal.socket.requestRobState(qian_state.buqiang)\r\n                this.robUI.active = false\r\n                if(isopen_sound){\r\n                    cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\")) \r\n                 }\r\n                 break    \r\n             case \"nopushcard\":  //不出牌\r\n                 myglobal.socket.request_buchu_card([],null)\r\n                 this.playingUI_node.active = false\r\n                 break\r\n             case \"pushcard\":   //出牌\r\n                 //先获取本次出牌数据\r\n                 if(this.choose_card_data.length==0){\r\n                    this.tipsLabel.string=\"请选择牌!\"\r\n                    setTimeout(function(){\r\n                        this.tipsLabel.string=\"\"\r\n                    }.bind(this), 2000);\r\n                 }\r\n                 myglobal.socket.request_chu_card(this.choose_card_data,function(err,data){\r\n                   \r\n                    if(err){\r\n                        console.log(\"request_chu_card:\"+err)\r\n                        console.log(\"request_chu_card\"+JSON.stringify(data))\r\n                        if(this.tipsLabel.string==\"\"){\r\n                            this.tipsLabel.string = data.msg\r\n                            setTimeout(function(){\r\n                                this.tipsLabel.string=\"\"\r\n                            }.bind(this), 2000);\r\n                        }\r\n                        \r\n                        //出牌失败，把选择的牌归位\r\n                        for(var i=0;i<this.cards_nods.length;i++){\r\n                            var card = this.cards_nods[i]\r\n                            card.emit(\"reset_card_flag\")\r\n                        }\r\n                        this.choose_card_data = []\r\n                     }else{\r\n                         //出牌成功\r\n                         console.log(\"resp_chu_card data:\"+JSON.stringify(data))\r\n                         this.playingUI_node.active = false\r\n                         //播放出牌的声音\r\n                         //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\r\n                         //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\r\n                         this.playPushCardSound(data.cardvalue.name)\r\n                         this.destoryCard(data.account,this.choose_card_data)\r\n                         this.choose_card_data = []\r\n                     \r\n                     }\r\n                    \r\n                 }.bind(this))\r\n                 //this.playingUI_node.active = false\r\n                 break\r\n             case \"tipcard\":\r\n                 break            \r\n            default:\r\n                break\r\n        }\r\n    }\r\n\r\n\r\n});\r\n"]}