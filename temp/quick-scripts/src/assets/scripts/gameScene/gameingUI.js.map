{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\gameScene/assets\\scripts\\gameScene\\gameingUI.js"],"names":["cc","Class","Component","properties","gameingUI","Node","card_prefab","Prefab","robUI","timeLabel","Label","bottom_card_pos_node","playingUI_node","tipsLabel","fapai","type","AudioClip","onLoad","cards_nods","card_width","rob_player_accountid","fapai_end","bottom_card","bottom_card_data","choose_card_data","outcar_zone","push_card_tmp","myglobal","socket","onCanChuCard","data","console","log","JSON","stringify","playerData","userId","clearOutZone","active","bind","onOtherPlayerChuCard","accountid","gameScene_script","node","parent","getComponent","outCard_node","getUserOutCardPosByAccount","node_cards","i","cards","length","card","instantiate","showCards","card_data","push","appendOtherCardsToOutZone","on","show_data","call_data","run","callFunc","target","activedata","show_card","obj","runAction","sequence","rotateBy","scaleBy","isopen_sound","audioEngine","play","url","raw","master_accountid","scheduleOnce","pushThreeCard","event","detail","cardid","splice","start","window","$socket","pushCardNotify","canrobNotify","onDestroy","remove","cur_index_card","pushCard","_runactive_pushcard","emit","customSchedulerOnce","stop","fapai_audioID","sendevent","move_node","common","audio","PlayEffect","newx","x","action","moveTo","v2","count","callback","unschedule","state","qian_state","buqiang","string","schedule","sortCard","sort","y","a","b","hasOwnProperty","value","king","timeout","setTimeout","zIndex","width","scale","di_card","position","schedulePushThreeCard","last_card_x","destoryCard","choose_card","destroy_card","j","card_id","removeFromParent","appendCardsToOutZone","updateCards","children","destroy","removeAllChildren","pushCardSort","yoffset","addChild","zPoint","cardNode","getChildren","setScale","setPosition","zeroPoint","playPushCardSound","card_name","CardsValue","one","name","onButtonClick","customData","requestRobState","qian","request_buchu_card","request_chu_card","err","msg","cardvalue","account"],"mappings":";;;;;;AAAA;;;;AAEAA,EAAE,CAACC,KAAH,CAAS;AACP,aAASD,EAAE,CAACE,SADL;AAGPC,EAAAA,UAAU,EAAE;AACVC,IAAAA,SAAS,EAAEJ,EAAE,CAACK,IADJ;AAEVC,IAAAA,WAAW,EAAEN,EAAE,CAACO,MAFN;AAGVC,IAAAA,KAAK,EAAER,EAAE,CAACK,IAHA;AAGM;AAChBI,IAAAA,SAAS,EAAET,EAAE,CAACU,KAJJ;AAIW;AACrBC,IAAAA,oBAAoB,EAAEX,EAAE,CAACK,IALf;AAKqB;AAC/BO,IAAAA,cAAc,EAAEZ,EAAE,CAACK,IANT;AAOVQ,IAAAA,SAAS,EAAEb,EAAE,CAACU,KAPJ;AAOW;AACrBI,IAAAA,KAAK,EAAE;AACLC,MAAAA,IAAI,EAAEf,EAAE,CAACgB,SADJ;AAEL,iBAAS;AAFJ;AARG,GAHL;AAkBPC,EAAAA,MAlBO,oBAkBE;AACP;AACA,SAAKC,UAAL,GAAkB,EAAlB;AACA,SAAKC,UAAL,GAAkB,CAAlB,CAHO,CAIP;;AACA,SAAKC,oBAAL,GAA4B,CAA5B,CALO,CAMP;;AACA,SAAKC,SAAL,GAAiB,KAAjB,CAPO,CAQP;;AACA,SAAKC,WAAL,GAAmB,EAAnB,CATO,CAUP;;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,gBAAL,GAAwB,EAAxB;AACA,SAAKC,WAAL,GAAmB,EAAnB;AAEA,SAAKC,aAAL,GAAqB,EAArB,CAfO,CAiBP;;AACAC,yBAASC,MAAT,CAAgBC,YAAhB,CAA6B,UAAUC,IAAV,EAAgB;AAC3CC,MAAAA,OAAO,CAACC,GAAR,CAAY,iBAAiBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA7B,EAD2C,CAE3C;;AACA,UAAIA,IAAI,IAAIH,qBAASQ,UAAT,CAAoBC,MAAhC,EAAwC;AACtC;AACA,aAAKC,YAAL,CAAkBV,qBAASQ,UAAT,CAAoBC,MAAtC,EAFsC,CAGtC;AACA;AACA;;AACA,aAAKxB,cAAL,CAAoB0B,MAApB,GAA6B,IAA7B;AAED;AACF,KAZ4B,CAY3BC,IAZ2B,CAYtB,IAZsB,CAA7B,EAlBO,CAgCP;;;AACAZ,yBAASC,MAAT,CAAgBY,oBAAhB,CAAqC,UAAUV,IAAV,EAAgB;AACnD;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAyBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAArC;AAEA,UAAIW,SAAS,GAAGX,IAAI,CAACW,SAArB;AACA,UAAIC,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB,CALmD,CAMnD;;AACA,UAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;;AACA,UAAIK,YAAY,IAAI,IAApB,EAA0B;AACxB;AACD;;AAED,UAAIE,UAAU,GAAG,EAAjB;;AACA,WAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACoB,KAAL,CAAWC,MAA/B,EAAuCF,CAAC,EAAxC,EAA4C;AAC1C,YAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,QAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoCxB,IAAI,CAACoB,KAAL,CAAWD,CAAX,EAAcM,SAAlD,EAA6D5B,qBAASQ,UAAT,CAAoBC,MAAjF;AACAY,QAAAA,UAAU,CAACQ,IAAX,CAAgBJ,IAAhB;AACD;;AACD,WAAKK,yBAAL,CAA+BX,YAA/B,EAA6CE,UAA7C,EAAyD,CAAzD;AAGD,KArBoC,CAqBnCT,IArBmC,CAqB9B,IArB8B,CAArC,EAjCO,CAwDP;;;AACA,SAAKI,IAAL,CAAUe,EAAV,CAAa,wBAAb,EAAuC,UAAU5B,IAAV,EAAgB;AACrDC,MAAAA,OAAO,CAACC,GAAR,CAAY,4BAAZ,EAA0C,CAACF,IAA3C;AAEA,WAAKP,gBAAL,GAAwBO,IAAxB;;AAEA,WAAK,IAAImB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGnB,IAAI,CAACqB,MAAzB,EAAiCF,CAAC,EAAlC,EAAsC;AACpC,YAAIG,IAAI,GAAG,KAAK9B,WAAL,CAAiB2B,CAAjB,CAAX;AACA,YAAIU,SAAS,GAAG7B,IAAI,CAACmB,CAAD,CAApB;AACA,YAAIW,SAAS,GAAG;AACd,iBAAOR,IADO;AAEd,kBAAQO;AAFM,SAAhB;AAIA5B,QAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsBC,IAAI,CAACC,SAAL,CAAeyB,SAAf,CAAlC;AACA,YAAIE,GAAG,GAAG7D,EAAE,CAAC8D,QAAH,CAAY,UAAUC,MAAV,EAAkBC,UAAlB,EAA8B;AAElD,cAAIC,SAAS,GAAGD,UAAU,CAACE,GAA3B;AACA,cAAIP,SAAS,GAAGK,UAAU,CAAClC,IAA3B,CAHkD,CAIlD;;AACAmC,UAAAA,SAAS,CAACpB,YAAV,CAAuB,MAAvB,EAA+BS,SAA/B,CAAyCK,SAAzC;AAED,SAPS,EAOP,IAPO,EAODC,SAPC,CAAV;AASAR,QAAAA,IAAI,CAACe,SAAL,CAAenE,EAAE,CAACoE,QAAH,CAAYpE,EAAE,CAACqE,QAAH,CAAY,CAAZ,EAAe,CAAf,EAAkB,GAAlB,CAAZ,EAAoCrE,EAAE,CAACqE,QAAH,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAAC,EAArB,CAApC,EAA8DR,GAA9D,EACb7D,EAAE,CAACqE,QAAH,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAAC,EAArB,CADa,EACarE,EAAE,CAACsE,OAAH,CAAW,CAAX,EAAc,GAAd,CADb,CAAf;;AAGA,YAAIC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,2BAAX,CAApB;AACD;AACF,OA5BoD,CA8BrD;AACA;;;AACA,UAAIhD,qBAASQ,UAAT,CAAoBC,MAApB,IAA8BT,qBAASQ,UAAT,CAAoByC,gBAAtD,EAAwE;AACtE,aAAKC,YAAL,CAAkB,KAAKC,aAAL,CAAmBvC,IAAnB,CAAwB,IAAxB,CAAlB,EAAiD,GAAjD;AACD;AAGF,KArCsC,CAqCrCA,IArCqC,CAqChC,IArCgC,CAAvC,EAzDO,CAgGP;;AACA,SAAKI,IAAL,CAAUe,EAAV,CAAa,mBAAb,EAAkC,UAAUqB,KAAV,EAAiB;AACjDhD,MAAAA,OAAO,CAACC,GAAR,CAAY,uBAAuBC,IAAI,CAACC,SAAL,CAAe6C,KAAf,CAAnC;AACA,UAAIC,MAAM,GAAGD,KAAb;AACA,WAAKvD,gBAAL,CAAsBgC,IAAtB,CAA2BwB,MAA3B;AACD,KAJiC,CAIhCzC,IAJgC,CAI3B,IAJ2B,CAAlC;AAMA,SAAKI,IAAL,CAAUe,EAAV,CAAa,qBAAb,EAAoC,UAAUqB,KAAV,EAAiB;AACnDhD,MAAAA,OAAO,CAACC,GAAR,CAAY,yBAAyB+C,KAArC;AACA,UAAIC,MAAM,GAAGD,KAAb;;AACA,WAAK,IAAI9B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKzB,gBAAL,CAAsB2B,MAA1C,EAAkDF,CAAC,EAAnD,EAAuD;AACrD,YAAI,KAAKzB,gBAAL,CAAsByB,CAAtB,EAAyBgC,MAAzB,IAAmCD,MAAvC,EAA+C;AAC7C,eAAKxD,gBAAL,CAAsB0D,MAAtB,CAA6BjC,CAA7B,EAAgC,CAAhC;AACD;AACF;AACF,KARmC,CAQlCV,IARkC,CAQ7B,IAR6B,CAApC;AAUD,GAnIM;AAqIP4C,EAAAA,KArIO,mBAqIC;AACN;AACAC,IAAAA,MAAM,CAACC,OAAP,CAAe3B,EAAf,CAAkB,iBAAlB,EAAqC,KAAK4B,cAA1C,EAA0D,IAA1D,EAFM,CAE0D;;AAChEF,IAAAA,MAAM,CAACC,OAAP,CAAe3B,EAAf,CAAkB,eAAlB,EAAmC,KAAK6B,YAAxC,EAAsD,IAAtD,EAHM,CAGsD;AAC7D,GAzIM;AA0IPC,EAAAA,SA1IO,uBA0IK;AACVJ,IAAAA,MAAM,CAACC,OAAP,CAAeI,MAAf,CAAsB,iBAAtB,EAAyC,IAAzC;AACAL,IAAAA,MAAM,CAACC,OAAP,CAAeI,MAAf,CAAsB,eAAtB,EAAuC,IAAvC;AACD,GA7IM;AA8IPH,EAAAA,cA9IO,0BA8IQxD,IA9IR,EA8Ic;AACnBC,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA5B;AACA,SAAKyB,SAAL,GAAiBzB,IAAjB;AACA,SAAK4D,cAAL,GAAsB5D,IAAI,CAACqB,MAAL,GAAc,CAApC;AACA,SAAKwC,QAAL,CAAc7D,IAAd,EAJmB,CAKnB;;AACA,SAAK+C,YAAL,CAAkB,KAAKe,mBAAL,CAAyBrD,IAAzB,CAA8B,IAA9B,CAAlB,EAAuD,GAAvD;AACA,SAAKI,IAAL,CAAUC,MAAV,CAAiBiD,IAAjB,CAAsB,sBAAtB;AACD,GAtJM;AAuJP;AACAD,EAAAA,mBAxJO,iCAwJe;AACpB,QAAI,KAAKF,cAAL,GAAsB,CAA1B,EAA6B;AAC3B3D,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ,EAD2B,CAE3B;;AACA,WAAKX,SAAL,GAAiB,IAAjB;;AACA,UAAI,KAAKD,oBAAL,KAA8BO,qBAASQ,UAAT,CAAoBC,MAAtD,EAA8D;AAC5D,aAAK5B,KAAL,CAAW8B,MAAX,GAAoB,IAApB;AACA,aAAKwD,mBAAL;AACD;;AAED,UAAIvB,YAAJ,EAAkB;AAChB;AACAvE,QAAAA,EAAE,CAACwE,WAAH,CAAeuB,IAAf,CAAoB,KAAKC,aAAzB;AACD,OAZ0B,CAa3B;;;AACA,UAAIC,SAAS,GAAG,KAAK7E,oBAArB;AACA,WAAKuB,IAAL,CAAUC,MAAV,CAAiBiD,IAAjB,CAAsB,cAAtB,EAAsCI,SAAtC;AACA;AACD,KAlBmB,CAoBpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,QAAIC,SAAS,GAAG,KAAKhF,UAAL,CAAgB,KAAKA,UAAL,CAAgBiC,MAAhB,GAAyB,KAAKuC,cAA9B,GAA+C,CAA/D,CAAhB;AACAQ,IAAAA,SAAS,CAAC5D,MAAV,GAAmB,IAAnB;AACA,SAAKZ,aAAL,CAAmB8B,IAAnB,CAAwB0C,SAAxB;AACA,SAAKF,aAAL,GAAqBG,MAAM,CAACC,KAAP,CAAaC,UAAb,CAAwB,KAAKvF,KAA7B,CAArB;;AACA,SAAK,IAAImC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKvB,aAAL,CAAmByB,MAAnB,GAA4B,CAAhD,EAAmDF,CAAC,EAApD,EAAwD;AACtD,UAAIiD,SAAS,GAAG,KAAKxE,aAAL,CAAmBuB,CAAnB,CAAhB;AACA,UAAIqD,IAAI,GAAGJ,SAAS,CAACK,CAAV,GAAe,KAAKpF,UAAL,GAAkB,GAA5C;AACA,UAAIqF,MAAM,GAAGxG,EAAE,CAACyG,MAAH,CAAU,GAAV,EAAezG,EAAE,CAAC0G,EAAH,CAAMJ,IAAN,EAAY,CAAC,GAAb,CAAf,CAAb;AACAJ,MAAAA,SAAS,CAAC/B,SAAV,CAAoBqC,MAApB;AACD;;AAED,SAAKd,cAAL;AACA,SAAKb,YAAL,CAAkB,KAAKe,mBAAL,CAAyBrD,IAAzB,CAA8B,IAA9B,CAAlB,EAAuD,GAAvD;AACD,GAnMM;AAoMP;AACAuD,EAAAA,mBArMO,iCAqMe;AACpB,SAAKa,KAAL,GAAa,EAAb;;AACA,QAAMC,QAAQ,GAAG,SAAXA,QAAW,GAAY;AAC3B,UAAI,CAAC,KAAKD,KAAV,EAAiB;AACf;AACA,aAAKnG,KAAL,CAAW8B,MAAX,GAAoB,KAApB;AACA,aAAKuE,UAAL,CAAgBD,QAAhB;AACAxB,QAAAA,MAAM,CAACC,OAAP,CAAeQ,IAAf,CAAoB,qBAApB,EAA2C;AACzCzD,UAAAA,MAAM,EAAET,qBAASQ,UAAT,CAAoBC,MADa;AAEzC0E,UAAAA,KAAK,EAAEC,UAAU,CAACC;AAFuB,SAA3C;AAID;;AACD,WAAKvG,SAAL,CAAewG,MAAf,GAAwB,EAAE,KAAKN,KAA/B;AACD,KAXD;;AAYA,SAAKO,QAAL,CAAcN,QAAd,EAAwB,CAAxB,EAA2B,EAA3B;AACD,GApNM;AAqNP;AACArB,EAAAA,YAtNO,wBAsNMzD,IAtNN,EAsNY;AACjBC,IAAAA,OAAO,CAACC,GAAR,CAAY,eAAZ,EAA6BF,IAA7B,EADiB,CAEjB;;AACA,SAAKV,oBAAL,GAA4BU,IAA5B;;AACA,QAAIA,IAAI,KAAKH,qBAASQ,UAAT,CAAoBC,MAA7B,IAAuC,KAAKf,SAAhD,EAA2D;AACzD,WAAKb,KAAL,CAAW8B,MAAX,GAAoB,IAApB;AACD;AACF,GA7NM;AA8NP;AACA6E,EAAAA,QA/NO,sBA+NI;AACT,SAAKjG,UAAL,CAAgBkG,IAAhB,CAAqB,UAAUb,CAAV,EAAac,CAAb,EAAgB;AACnC,UAAIC,CAAC,GAAGf,CAAC,CAAC1D,YAAF,CAAe,MAAf,EAAuBU,SAA/B;AACA,UAAIgE,CAAC,GAAGF,CAAC,CAACxE,YAAF,CAAe,MAAf,EAAuBU,SAA/B;;AAEA,UAAI+D,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,eAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,UAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAC,CAAR;AACD;;AACD,UAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAP;AACD;;AACD,UAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,eAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,KAhBD,EADS,CAkBT;AACA;AACA;;AACA,QAAIC,OAAO,GAAG,IAAd;AACAC,IAAAA,UAAU,CAAC,YAAY;AACrB;AACA,UAAIrB,CAAC,GAAG,KAAKrF,UAAL,CAAgB,CAAhB,EAAmBqF,CAA3B;AACAxE,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAYuE,CAAxB;;AACA,WAAK,IAAItD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK/B,UAAL,CAAgBiC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,YAAIG,IAAI,GAAG,KAAKlC,UAAL,CAAgB+B,CAAhB,CAAX;AACAG,QAAAA,IAAI,CAACyE,MAAL,GAAc5E,CAAd,CAF+C,CAE9B;;AACjBG,QAAAA,IAAI,CAACmD,CAAL,GAASA,CAAC,GAAGnD,IAAI,CAAC0E,KAAL,GAAa,GAAb,GAAmB7E,CAAhC;AACD;AACF,KATU,CASTV,IATS,CASJ,IATI,CAAD,EASIoF,OATJ,CAAV;AAYD,GAjQM;AAoQPhC,EAAAA,QApQO,oBAoQE7D,IApQF,EAoQQ;AACb,QAAIA,IAAJ,EAAU;AACRA,MAAAA,IAAI,CAACsF,IAAL,CAAU,UAAUE,CAAV,EAAaC,CAAb,EAAgB;AACxB,YAAID,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,iBAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,YAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,iBAAO,CAAC,CAAR;AACD;;AACD,YAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,iBAAO,CAAP;AACD;;AACD,YAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,iBAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,OAbD;AAcD,KAhBY,CAiBb;;;AACA,SAAKxG,UAAL,GAAkB,EAAlB;;AACA,SAAK,IAAI+B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,EAApB,EAAwBA,CAAC,EAAzB,EAA6B;AAE3B,UAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,MAAAA,IAAI,CAAC2E,KAAL,GAAa,GAAb;AACA3E,MAAAA,IAAI,CAACR,MAAL,GAAc,KAAKD,IAAL,CAAUC,MAAxB;AACAQ,MAAAA,IAAI,CAACmD,CAAL,GAASnD,IAAI,CAAC0E,KAAL,GAAa,GAAb,GAAoB,CAAC,GAArB,GAA6B,CAAC,EAA9B,GAAoC1E,IAAI,CAAC0E,KAAL,GAAa,GAAb,GAAmB,CAAhE,CAL2B,CAM3B;;AACA1E,MAAAA,IAAI,CAACiE,CAAL,GAAS,CAAC,GAAV;AACAjE,MAAAA,IAAI,CAACd,MAAL,GAAc,KAAd;AAEAc,MAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoCxB,IAAI,CAACmB,CAAD,CAAxC,EAA6CtB,qBAASQ,UAAT,CAAoBC,MAAjE,EAV2B,CAW3B;;AACA,WAAKlB,UAAL,CAAgBsC,IAAhB,CAAqBJ,IAArB;AACA,WAAKjC,UAAL,GAAkBiC,IAAI,CAAC0E,KAAvB;AACD,KAjCY,CAmCb;;;AACA,SAAKxG,WAAL,GAAmB,EAAnB;;AACA,SAAK,IAAI2B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,CAApB,EAAuBA,CAAC,EAAxB,EAA4B;AAC1B,UAAI+E,OAAO,GAAGhI,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAd;AACA0H,MAAAA,OAAO,CAACD,KAAR,GAAgB,GAAhB;AACAC,MAAAA,OAAO,CAACC,QAAR,GAAmB,KAAKtH,oBAAL,CAA0BsH,QAA7C,CAH0B,CAI1B;AACA;;AACA,UAAIhF,CAAC,IAAI,CAAT,EAAY;AACV+E,QAAAA,OAAO,CAACzB,CAAR,GAAYyB,OAAO,CAACzB,CAAR,GAAYyB,OAAO,CAACF,KAAR,GAAgB,GAAxC;AACD,OAFD,MAEO,IAAI7E,CAAC,IAAI,CAAT,EAAY;AACjB+E,QAAAA,OAAO,CAACzB,CAAR,GAAYyB,OAAO,CAACzB,CAAR,GAAYyB,OAAO,CAACF,KAAR,GAAgB,GAAxC;AACD,OAVyB,CAa1B;AACA;;;AACAE,MAAAA,OAAO,CAACpF,MAAR,GAAiB,KAAKD,IAAL,CAAUC,MAA3B,CAf0B,CAgB1B;;AACA,WAAKtB,WAAL,CAAiBkC,IAAjB,CAAsBwE,OAAtB;AACD;AAEF,GA7TM;AA+TP;AACAE,EAAAA,qBAhUO,mCAgUiB;AACtB,SAAK,IAAIjF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK/B,UAAL,CAAgBiC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,UAAIG,IAAI,GAAG,KAAKlC,UAAL,CAAgB+B,CAAhB,CAAX;;AACA,UAAIG,IAAI,CAACiE,CAAL,IAAU,CAAC,GAAf,EAAoB;AAClBjE,QAAAA,IAAI,CAACiE,CAAL,GAAS,CAAC,GAAV;AACD;AACF;AACF,GAvUM;AAwUP;AACAvC,EAAAA,aAzUO,2BAyUS;AACd;AACA,QAAIqD,WAAW,GAAG,KAAKjH,UAAL,CAAgB,KAAKA,UAAL,CAAgBiC,MAAhB,GAAyB,CAAzC,EAA4CoD,CAA9D;;AACA,SAAK,IAAItD,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK1B,gBAAL,CAAsB4B,MAA1C,EAAkDF,CAAC,EAAnD,EAAuD;AACrD,UAAIG,IAAI,GAAGpD,EAAE,CAACqD,WAAH,CAAe,KAAK/C,WAApB,CAAX;AACA8C,MAAAA,IAAI,CAAC2E,KAAL,GAAa,GAAb;AACA3E,MAAAA,IAAI,CAACR,MAAL,GAAc,KAAKD,IAAL,CAAUC,MAAxB;AAEAQ,MAAAA,IAAI,CAACmD,CAAL,GAAS4B,WAAW,GAAI,CAAClF,CAAC,GAAG,CAAL,IAAU,KAAK9B,UAAf,GAA4B,GAApD;AACAiC,MAAAA,IAAI,CAACiE,CAAL,GAAS,CAAC,GAAV,CANqD,CAMtC;AAEf;;AACAjE,MAAAA,IAAI,CAACP,YAAL,CAAkB,MAAlB,EAA0BS,SAA1B,CAAoC,KAAK/B,gBAAL,CAAsB0B,CAAtB,CAApC,EAA8DtB,qBAASQ,UAAT,CAAoBC,MAAlF;AACAgB,MAAAA,IAAI,CAACd,MAAL,GAAc,IAAd;AACA,WAAKpB,UAAL,CAAgBsC,IAAhB,CAAqBJ,IAArB;AACD;;AAED,SAAK+D,QAAL,GAjBc,CAkBd;;AACA,SAAKtC,YAAL,CAAkB,KAAKqD,qBAAL,CAA2B3F,IAA3B,CAAgC,IAAhC,CAAlB,EAAyD,CAAzD;AAED,GA9VM;AAgWP6F,EAAAA,WAhWO,uBAgWK3F,SAhWL,EAgWgB4F,WAhWhB,EAgW6B;AAClC,QAAIA,WAAW,CAAClF,MAAZ,IAAsB,CAA1B,EAA6B;AAC3B;AACD;AAED;;;;;;;;;;AAUA;;;AACA,QAAImF,YAAY,GAAG,EAAnB;;AACA,SAAK,IAAIrF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoF,WAAW,CAAClF,MAAhC,EAAwCF,CAAC,EAAzC,EAA6C;AAC3C,WAAK,IAAIsF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAKrH,UAAL,CAAgBiC,MAApC,EAA4CoF,CAAC,EAA7C,EAAiD;AAC/C,YAAIC,OAAO,GAAG,KAAKtH,UAAL,CAAgBqH,CAAhB,EAAmB1F,YAAnB,CAAgC,MAAhC,EAAwC2F,OAAtD;;AACA,YAAIA,OAAO,IAAIH,WAAW,CAACpF,CAAD,CAAX,CAAegC,MAA9B,EAAsC;AACpClD,UAAAA,OAAO,CAACC,GAAR,CAAY,qBAAqBwG,OAAjC,EADoC,CAEpC;;AACA,eAAKtH,UAAL,CAAgBqH,CAAhB,EAAmBE,gBAAnB,CAAoC,IAApC;AACAH,UAAAA,YAAY,CAAC9E,IAAb,CAAkB,KAAKtC,UAAL,CAAgBqH,CAAhB,CAAlB;AACA,eAAKrH,UAAL,CAAgBgE,MAAhB,CAAuBqD,CAAvB,EAA0B,CAA1B;AACD;AACF;AACF;;AAED,SAAKG,oBAAL,CAA0BjG,SAA1B,EAAqC6F,YAArC;AACA,SAAKK,WAAL;AAED,GAjYM;AAmYP;AACAtG,EAAAA,YApYO,wBAoYMI,SApYN,EAoYiB;AACtB,QAAIC,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB;AACA,QAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;AACA,QAAImG,QAAQ,GAAG9F,YAAY,CAAC8F,QAA5B;;AACA,SAAK,IAAI3F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG2F,QAAQ,CAACzF,MAA7B,EAAqCF,CAAC,EAAtC,EAA0C;AACxC,UAAIG,IAAI,GAAGwF,QAAQ,CAAC3F,CAAD,CAAnB;AACAG,MAAAA,IAAI,CAACyF,OAAL;AACD;;AACD/F,IAAAA,YAAY,CAACgG,iBAAb,CAA+B,IAA/B;AACD,GA7YM;AA8YP;AACAC,EAAAA,YA/YO,wBA+YM7F,KA/YN,EA+Ya;AAClB,QAAIA,KAAK,CAACC,MAAN,IAAgB,CAApB,EAAuB;AACrB;AACD;;AACDD,IAAAA,KAAK,CAACkE,IAAN,CAAW,UAAUb,CAAV,EAAac,CAAb,EAAgB;AACzB,UAAIC,CAAC,GAAGf,CAAC,CAAC1D,YAAF,CAAe,MAAf,EAAuBU,SAA/B;AACA,UAAIgE,CAAC,GAAGF,CAAC,CAACxE,YAAF,CAAe,MAAf,EAAuBU,SAA/B;;AAEA,UAAI+D,CAAC,CAACE,cAAF,CAAiB,OAAjB,KAA6BD,CAAC,CAACC,cAAF,CAAiB,OAAjB,CAAjC,EAA4D;AAC1D,eAAOD,CAAC,CAACE,KAAF,GAAUH,CAAC,CAACG,KAAnB;AACD;;AACD,UAAIH,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4B,CAACD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAC,CAAR;AACD;;AACD,UAAI,CAACF,CAAC,CAACE,cAAF,CAAiB,MAAjB,CAAD,IAA6BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAjC,EAA2D;AACzD,eAAO,CAAP;AACD;;AACD,UAAIF,CAAC,CAACE,cAAF,CAAiB,MAAjB,KAA4BD,CAAC,CAACC,cAAF,CAAiB,MAAjB,CAAhC,EAA0D;AACxD,eAAOD,CAAC,CAACG,IAAF,GAASJ,CAAC,CAACI,IAAlB;AACD;AACF,KAhBD;AAiBD,GApaM;AAsaPjE,EAAAA,yBAtaO,qCAsamBX,YAtanB,EAsaiCI,KAtajC,EAsawC8F,OAtaxC,EAsaiD;AACtDlG,IAAAA,YAAY,CAACgG,iBAAb,CAA+B,IAA/B,EADsD,CAGtD;AACA;;AACA,SAAK,IAAI7F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,KAAK,CAACC,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AACrC,UAAIG,IAAI,GAAGF,KAAK,CAACD,CAAD,CAAhB;AACAH,MAAAA,YAAY,CAACmG,QAAb,CAAsB7F,IAAtB,EAA4B,MAAMH,CAAlC,EAFqC,CAEA;AACtC,KARqD,CAUtD;AACA;;;AACA,QAAIiG,MAAM,GAAGhG,KAAK,CAACC,MAAN,GAAe,CAA5B,CAZsD,CAatD;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,KAAK,CAACC,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AACrC,UAAIkG,QAAQ,GAAGrG,YAAY,CAACsG,WAAb,GAA2BnG,CAA3B,CAAf;AACA,UAAIsD,CAAC,GAAG,CAACtD,CAAC,GAAGiG,MAAL,IAAe,EAAvB;AACA,UAAI7B,CAAC,GAAG8B,QAAQ,CAAC9B,CAAT,GAAa2B,OAArB,CAHqC,CAGP;AAC9B;;AACAG,MAAAA,QAAQ,CAACE,QAAT,CAAkB,GAAlB,EAAuB,GAAvB;AACAF,MAAAA,QAAQ,CAACG,WAAT,CAAqB/C,CAArB,EAAwBc,CAAxB;AAED;AACF,GA7bM;AA8bP;AACA;AACAqB,EAAAA,oBAhcO,gCAgccjG,SAhcd,EAgcyB6F,YAhczB,EAgcuC;AAC5C,QAAIA,YAAY,CAACnF,MAAb,IAAuB,CAA3B,EAA8B;AAC5B;AACD,KAH2C,CAI5C;;;AACA,SAAK4F,YAAL,CAAkBT,YAAlB,EAL4C,CAM5C;;AACA,QAAI5F,gBAAgB,GAAG,KAAKC,IAAL,CAAUC,MAAV,CAAiBC,YAAjB,CAA8B,WAA9B,CAAvB,CAP4C,CAQ5C;;AACA,QAAIC,YAAY,GAAGJ,gBAAgB,CAACK,0BAAjB,CAA4CN,SAA5C,CAAnB;AACA,SAAKgB,yBAAL,CAA+BX,YAA/B,EAA6CwF,YAA7C,EAA2D,GAA3D,EAV4C,CAW5C;AAED,GA7cM;AA+cP;AACAK,EAAAA,WAhdO,yBAgdO;AAEZ,QAAIY,SAAS,GAAG,KAAKrI,UAAL,CAAgBiC,MAAhB,GAAyB,CAAzC,CAFY,CAGZ;;AACA,SAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK/B,UAAL,CAAgBiC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,UAAIkG,QAAQ,GAAG,KAAKjI,UAAL,CAAgB+B,CAAhB,CAAf;AACA,UAAIsD,CAAC,GAAG,CAACtD,CAAC,GAAGsG,SAAL,KAAmB,KAAKpI,UAAL,GAAkB,GAArC,CAAR;AACAgI,MAAAA,QAAQ,CAACG,WAAT,CAAqB/C,CAArB,EAAwB,CAAC,GAAzB;AACD;AAEF,GA1dM;AA4dPiD,EAAAA,iBA5dO,6BA4dWC,SA5dX,EA4dsB;AAC3B1H,IAAAA,OAAO,CAACC,GAAR,CAAY,uBAAuByH,SAAnC;;AAEA,QAAIA,SAAS,IAAI,EAAjB,EAAqB;AACnB;AACD;;AAED,YAAQA,SAAR;AACE,WAAKC,UAAU,CAACC,GAAX,CAAeC,IAApB;AACE;;AACF,WAAKF,UAAU,UAAV,CAAkBE,IAAvB;AACE,YAAIrF,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,2BAAX,CAApB;AACD;;AACD;AAPJ;AASD,GA5eM;AA6eP;AACAkF,EAAAA,aA9eO,yBA8eO9E,KA9eP,EA8ec+E,UA9ed,EA8e0B;AAC/B,YAAQA,UAAR;AACE,WAAK,YAAL;AACE/H,QAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ;;AACAL,6BAASC,MAAT,CAAgBmI,eAAhB,CAAgChD,UAAU,CAACiD,IAA3C;;AACA,aAAKxJ,KAAL,CAAW8B,MAAX,GAAoB,KAApB;;AACA,YAAIiC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,uCAAX,CAApB;AACD;;AACD;;AACF,WAAK,cAAL;AACE5C,QAAAA,OAAO,CAACC,GAAR,CAAY,cAAZ;;AACAL,6BAASC,MAAT,CAAgBmI,eAAhB,CAAgChD,UAAU,CAACC,OAA3C;;AACA,aAAKxG,KAAL,CAAW8B,MAAX,GAAoB,KAApB;;AACA,YAAIiC,YAAJ,EAAkB;AAChBvE,UAAAA,EAAE,CAACwE,WAAH,CAAeC,IAAf,CAAoBzE,EAAE,CAAC0E,GAAH,CAAOC,GAAP,CAAW,mCAAX,CAApB;AACD;;AACD;;AACF,WAAK,YAAL;AAAoB;AAClBhD,6BAASC,MAAT,CAAgBqI,kBAAhB,CAAmC,EAAnC,EAAuC,IAAvC;;AACA,aAAKrJ,cAAL,CAAoB0B,MAApB,GAA6B,KAA7B;AACA;;AACF,WAAK,UAAL;AAAmB;AACjB;AACA,YAAI,KAAKd,gBAAL,CAAsB2B,MAAtB,IAAgC,CAApC,EAAuC;AACrC,eAAKtC,SAAL,CAAeoG,MAAf,GAAwB,OAAxB;AACAW,UAAAA,UAAU,CAAC,YAAY;AACrB,iBAAK/G,SAAL,CAAeoG,MAAf,GAAwB,EAAxB;AACD,WAFU,CAET1E,IAFS,CAEJ,IAFI,CAAD,EAEI,IAFJ,CAAV;AAGD;;AACDZ,6BAASC,MAAT,CAAgBsI,gBAAhB,CAAiC,KAAK1I,gBAAtC,EAAwD,UAAU2I,GAAV,EAAerI,IAAf,EAAqB;AAE3E,cAAIqI,GAAJ,EAAS;AACPpI,YAAAA,OAAO,CAACC,GAAR,CAAY,sBAAsBmI,GAAlC;AACApI,YAAAA,OAAO,CAACC,GAAR,CAAY,qBAAqBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAAjC;;AACA,gBAAI,KAAKjB,SAAL,CAAeoG,MAAf,IAAyB,EAA7B,EAAiC;AAC/B,mBAAKpG,SAAL,CAAeoG,MAAf,GAAwBnF,IAAI,CAACsI,GAA7B;AACAxC,cAAAA,UAAU,CAAC,YAAY;AACrB,qBAAK/G,SAAL,CAAeoG,MAAf,GAAwB,EAAxB;AACD,eAFU,CAET1E,IAFS,CAEJ,IAFI,CAAD,EAEI,IAFJ,CAAV;AAGD,aARM,CAUP;;;AACA,iBAAK,IAAIU,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,KAAK/B,UAAL,CAAgBiC,MAApC,EAA4CF,CAAC,EAA7C,EAAiD;AAC/C,kBAAIG,IAAI,GAAG,KAAKlC,UAAL,CAAgB+B,CAAhB,CAAX;AACAG,cAAAA,IAAI,CAACyC,IAAL,CAAU,iBAAV;AACD;;AACD,iBAAKrE,gBAAL,GAAwB,EAAxB;AACD,WAhBD,MAgBO;AACL;AACAO,YAAAA,OAAO,CAACC,GAAR,CAAY,wBAAwBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAApC;AACA,iBAAKlB,cAAL,CAAoB0B,MAApB,GAA6B,KAA7B,CAHK,CAIL;AACA;AACA;;AACA,iBAAKkH,iBAAL,CAAuB1H,IAAI,CAACuI,SAAL,CAAeT,IAAtC;AACA,iBAAKxB,WAAL,CAAiBtG,IAAI,CAACwI,OAAtB,EAA+B,KAAK9I,gBAApC;AACA,iBAAKA,gBAAL,GAAwB,EAAxB;AAED;AAEF,SA/BuD,CA+BtDe,IA/BsD,CA+BjD,IA/BiD,CAAxD,EARF,CAwCE;;;AACA;;AACF,WAAK,SAAL;AACE;;AACF;AACE;AAlEJ;AAoED;AAnjBM,CAAT","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\gameScene","sourcesContent":["import myglobal from \"../mygolbal.js\"\r\n\r\ncc.Class({\r\n  extends: cc.Component,\r\n\r\n  properties: {\r\n    gameingUI: cc.Node,\r\n    card_prefab: cc.Prefab,\r\n    robUI: cc.Node, // 抢地主按钮节点\r\n    timeLabel: cc.Label, // 计时器节点\r\n    bottom_card_pos_node: cc.Node, // 底牌节点\r\n    playingUI_node: cc.Node,\r\n    tipsLabel: cc.Label, //玩家出牌不合法的tips\r\n    fapai: {\r\n      type: cc.AudioClip,\r\n      default: null\r\n    }\r\n    \r\n  },\r\n\r\n  onLoad() {\r\n    //自己牌列表 \r\n    this.cards_nods = []\r\n    this.card_width = 0\r\n    //当前可以抢地主的accountid\r\n    this.rob_player_accountid = 0\r\n    //发牌动画是否结束\r\n    this.fapai_end = false\r\n    //底牌数组\r\n    this.bottom_card = []\r\n    //底牌的json对象数据\r\n    this.bottom_card_data = []\r\n    this.choose_card_data = []\r\n    this.outcar_zone = []\r\n\r\n    this.push_card_tmp = []\r\n\r\n    //监听服务器可以出牌消息\r\n    myglobal.socket.onCanChuCard(function (data) {\r\n      console.log(\"onCanChuCard\" + JSON.stringify(data))\r\n      //判断是不是自己能出牌\r\n      if (data == myglobal.playerData.userId) {\r\n        //先清理出牌区域\r\n        this.clearOutZone(myglobal.playerData.userId)\r\n        //先把自己出牌列表置空\r\n        //this.choose_card_data=[]\r\n        //显示可以出牌的UI\r\n        this.playingUI_node.active = true\r\n\r\n      }\r\n    }.bind(this))\r\n\r\n    //监听服务器：其他玩家出牌消息\r\n    myglobal.socket.onOtherPlayerChuCard(function (data) {\r\n      //{\"accountid\":\"2357540\",\"cards\":[{\"cardid\":4,\"card_data\":{\"index\":4,\"value\":1,\"shape\":1}}]}\r\n      console.log(\"onOtherPlayerChuCard\" + JSON.stringify(data))\r\n\r\n      var accountid = data.accountid\r\n      var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n      //获取出牌区域节点\r\n      var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n      if (outCard_node == null) {\r\n        return\r\n      }\r\n\r\n      var node_cards = []\r\n      for (var i = 0; i < data.cards.length; i++) {\r\n        var card = cc.instantiate(this.card_prefab)\r\n        card.getComponent(\"card\").showCards(data.cards[i].card_data, myglobal.playerData.userId)\r\n        node_cards.push(card)\r\n      }\r\n      this.appendOtherCardsToOutZone(outCard_node, node_cards, 0)\r\n\r\n\r\n    }.bind(this))\r\n\r\n    //内部事件:显示底牌事件,data是三张底牌数据\r\n    this.node.on(\"show_bottom_card_event\", function (data) {\r\n      console.log(\"----show_bottom_card_event\", +data)\r\n\r\n      this.bottom_card_data = data\r\n\r\n      for (var i = 0; i < data.length; i++) {\r\n        var card = this.bottom_card[i]\r\n        var show_data = data[i]\r\n        var call_data = {\r\n          \"obj\": card,\r\n          \"data\": show_data,\r\n        }\r\n        console.log(\"bottom show_data:\" + JSON.stringify(show_data))\r\n        var run = cc.callFunc(function (target, activedata) {\r\n\r\n          var show_card = activedata.obj\r\n          var show_data = activedata.data\r\n          //console.log(\"cc.callFunc:\"+JSON.stringify(show_data))\r\n          show_card.getComponent(\"card\").showCards(show_data)\r\n\r\n        }, this, call_data)\r\n\r\n        card.runAction(cc.sequence(cc.rotateBy(0, 0, 180), cc.rotateBy(0.2, 0, -90), run,\r\n          cc.rotateBy(0.2, 0, -90), cc.scaleBy(1, 1.2)));\r\n\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/start.mp3\"))\r\n        }\r\n      }\r\n\r\n      //this.node.parent.emit(\"change_room_state_event\",defines.gameState.ROOM_PLAYING)\r\n      //如果自己地主，给加上三张底牌\r\n      if (myglobal.playerData.userId == myglobal.playerData.master_accountid) {\r\n        this.scheduleOnce(this.pushThreeCard.bind(this), 0.2)\r\n      }\r\n\r\n\r\n    }.bind(this))\r\n\r\n    //注册监听一个选择牌消息 \r\n    this.node.on(\"choose_card_event\", function (event) {\r\n      console.log(\"choose_card_event:\" + JSON.stringify(event))\r\n      var detail = event\r\n      this.choose_card_data.push(detail)\r\n    }.bind(this))\r\n\r\n    this.node.on(\"unchoose_card_event\", function (event) {\r\n      console.log(\"unchoose_card_event:\" + event)\r\n      var detail = event\r\n      for (var i = 0; i < this.choose_card_data.length; i++) {\r\n        if (this.choose_card_data[i].cardid == detail) {\r\n          this.choose_card_data.splice(i, 1)\r\n        }\r\n      }\r\n    }.bind(this))\r\n\r\n  },\r\n\r\n  start() {\r\n    //监听服务器\r\n    window.$socket.on('pushcard_notify', this.pushCardNotify, this) // 发牌\r\n    window.$socket.on('canrob_notify', this.canrobNotify, this) // 抢地主\r\n  },\r\n  onDestroy() {\r\n    window.$socket.remove('pushcard_notify', this)\r\n    window.$socket.remove('canrob_notify', this)\r\n  },\r\n  pushCardNotify(data) {\r\n    console.log(\"onPushCards\" + JSON.stringify(data))\r\n    this.card_data = data\r\n    this.cur_index_card = data.length - 1\r\n    this.pushCard(data)\r\n    //左边移动定时器\r\n    this.scheduleOnce(this._runactive_pushcard.bind(this), 0.3)\r\n    this.node.parent.emit(\"pushcard_other_event\")\r\n  },\r\n  //处理发牌的效果\r\n  _runactive_pushcard() {\r\n    if (this.cur_index_card < 0) {\r\n      console.log(\"pushcard end\")\r\n      //发牌动画完成，显示抢地主按钮\r\n      this.fapai_end = true\r\n      if (this.rob_player_accountid === myglobal.playerData.userId) {\r\n        this.robUI.active = true\r\n        this.customSchedulerOnce()\r\n      }\r\n\r\n      if (isopen_sound) {\r\n        //console.log(\"start fapai_audioID\"+this.fapai_audioID) \r\n        cc.audioEngine.stop(this.fapai_audioID)\r\n      }\r\n      //通知gamescene节点，倒计时\r\n      var sendevent = this.rob_player_accountid\r\n      this.node.parent.emit(\"canrob_event\", sendevent)\r\n      return\r\n    }\r\n\r\n    //原有逻辑  \r\n    // var move_node = this.cards_nods[this.cur_index_card]\r\n    // move_node.active = true\r\n    // var newx = move_node.x + (this.card_width * 0.4*this.cur_index_card) - (this.card_width * 0.4)\r\n    // var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n    // move_node.runAction(action)\r\n    // this.cur_index_card--\r\n    // this.scheduleOnce(this._runactive_pushcard.bind(this),0.3)\r\n\r\n\r\n    var move_node = this.cards_nods[this.cards_nods.length - this.cur_index_card - 1]\r\n    move_node.active = true\r\n    this.push_card_tmp.push(move_node)\r\n    this.fapai_audioID = common.audio.PlayEffect(this.fapai)\r\n    for (var i = 0; i < this.push_card_tmp.length - 1; i++) {\r\n      var move_node = this.push_card_tmp[i]\r\n      var newx = move_node.x - (this.card_width * 0.4)\r\n      var action = cc.moveTo(0.1, cc.v2(newx, -250));\r\n      move_node.runAction(action)\r\n    }\r\n\r\n    this.cur_index_card--\r\n    this.scheduleOnce(this._runactive_pushcard.bind(this), 0.3)\r\n  },\r\n  //开启一个定时器\r\n  customSchedulerOnce() {\r\n    this.count = 10;\r\n    const callback = function () {\r\n      if (!this.count) {\r\n        // 在第六次执行回调时取消这个计时器\r\n        this.robUI.active = false\r\n        this.unschedule(callback)\r\n        window.$socket.emit('canrob_state_notify', {\r\n          userId: myglobal.playerData.userId,\r\n          state: qian_state.buqiang,\r\n        })\r\n      }\r\n      this.timeLabel.string = --this.count\r\n    }\r\n    this.schedule(callback, 1, 10)\r\n  },\r\n  // 通知抢地主消息,显示相应的UI\r\n  canrobNotify(data) {\r\n    console.log(\"onCanRobState\", data)\r\n    //这里需要2个变量条件：自己是下一个抢地主，2发牌动画结束\r\n    this.rob_player_accountid = data\r\n    if (data === myglobal.playerData.userId && this.fapai_end) {\r\n      this.robUI.active = true\r\n    }\r\n  },\r\n  //对牌排序\r\n  sortCard() {\r\n    this.cards_nods.sort(function (x, y) {\r\n      var a = x.getComponent(\"card\").card_data;\r\n      var b = y.getComponent(\"card\").card_data;\r\n\r\n      if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n        return b.value - a.value;\r\n      }\r\n      if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n        return -1;\r\n      }\r\n      if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return 1;\r\n      }\r\n      if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return b.king - a.king;\r\n      }\r\n    })\r\n    //var x = this.cards_nods[0].x;\r\n    //这里使用固定坐标，因为取this.cards_nods[0].xk可能排序为完成，导致x错误\r\n    //所以做1000毫秒的延时\r\n    var timeout = 1000\r\n    setTimeout(function () {\r\n      //var x = -417.6 \r\n      var x = this.cards_nods[0].x;\r\n      console.log(\"sort x:\" + x)\r\n      for (let i = 0; i < this.cards_nods.length; i++) {\r\n        var card = this.cards_nods[i];\r\n        card.zIndex = i; //设置牌的叠加次序,zindex越大显示在上面\r\n        card.x = x + card.width * 0.4 * i;\r\n      }\r\n    }.bind(this), timeout);\r\n\r\n\r\n  },\r\n\r\n\r\n  pushCard(data) {\r\n    if (data) {\r\n      data.sort(function (a, b) {\r\n        if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n          return b.value - a.value;\r\n        }\r\n        if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n          return -1;\r\n        }\r\n        if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n          return 1;\r\n        }\r\n        if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n          return b.king - a.king;\r\n        }\r\n      });\r\n    }\r\n    //创建card预制体\r\n    this.cards_nods = []\r\n    for (var i = 0; i < 17; i++) {\r\n\r\n      var card = cc.instantiate(this.card_prefab)\r\n      card.scale = 0.8\r\n      card.parent = this.node.parent\r\n      card.x = card.width * 0.4 * (-0.5) * (-16) + card.width * 0.4 * 0;\r\n      //这里实现为，每发一张牌，放在已经发的牌最后，然后整体移动\r\n      card.y = -250\r\n      card.active = false\r\n\r\n      card.getComponent(\"card\").showCards(data[i], myglobal.playerData.userId)\r\n      //存储牌的信息,用于后面发牌效果\r\n      this.cards_nods.push(card)\r\n      this.card_width = card.width\r\n    }\r\n\r\n    //创建3张底牌\r\n    this.bottom_card = []\r\n    for (var i = 0; i < 3; i++) {\r\n      var di_card = cc.instantiate(this.card_prefab)\r\n      di_card.scale = 0.4\r\n      di_card.position = this.bottom_card_pos_node.position\r\n      //三张牌，中间坐标就是bottom_card_pos_node节点坐标，\r\n      //0,和2两张牌左右移动windth*0.4\r\n      if (i == 0) {\r\n        di_card.x = di_card.x - di_card.width * 0.5\r\n      } else if (i == 2) {\r\n        di_card.x = di_card.x + di_card.width * 0.5\r\n      }\r\n\r\n\r\n      //di_card.x = di_card.width-i*di_card.width-20\r\n      //di_card.y=60\r\n      di_card.parent = this.node.parent\r\n      //存储在容器里\r\n      this.bottom_card.push(di_card)\r\n    }\r\n\r\n  },\r\n\r\n  //给玩家发送三张底牌后，过1s,把牌设置到y=-250位置效果\r\n  schedulePushThreeCard() {\r\n    for (var i = 0; i < this.cards_nods.length; i++) {\r\n      var card = this.cards_nods[i]\r\n      if (card.y == -230) {\r\n        card.y = -250\r\n      }\r\n    }\r\n  },\r\n  //给地主发三张排，并显示在原有牌的后面\r\n  pushThreeCard() {\r\n    //每张牌的其实位置 \r\n    var last_card_x = this.cards_nods[this.cards_nods.length - 1].x\r\n    for (var i = 0; i < this.bottom_card_data.length; i++) {\r\n      var card = cc.instantiate(this.card_prefab)\r\n      card.scale = 0.8\r\n      card.parent = this.node.parent\r\n\r\n      card.x = last_card_x + ((i + 1) * this.card_width * 0.4)\r\n      card.y = -230  //先把底盘放在-230，在设置个定时器下移到-250的位置\r\n\r\n      //console.log(\"pushThreeCard x:\"+card.x)\r\n      card.getComponent(\"card\").showCards(this.bottom_card_data[i], myglobal.playerData.userId)\r\n      card.active = true\r\n      this.cards_nods.push(card)\r\n    }\r\n\r\n    this.sortCard()\r\n    //设置一个定时器，在2s后，修改y坐标为-250\r\n    this.scheduleOnce(this.schedulePushThreeCard.bind(this), 2)\r\n\r\n  },\r\n\r\n  destoryCard(accountid, choose_card) {\r\n    if (choose_card.length == 0) {\r\n      return\r\n    }\r\n\r\n    /*出牌逻辑\r\n      1. 将选中的牌 从父节点中移除\r\n      2. 从this.cards_nods 数组中，删除 选中的牌 \r\n      3. 将 “选中的牌” 添加到出牌区域\r\n          3.1 清空出牌区域\r\n          3.2 添加子节点\r\n          3.3 设置scale\r\n          3.4 设置position\r\n      4.  重新设置手中的牌的位置  this.updateCards();\r\n    */\r\n    //1/2步骤删除自己手上的card节点 \r\n    var destroy_card = []\r\n    for (var i = 0; i < choose_card.length; i++) {\r\n      for (var j = 0; j < this.cards_nods.length; j++) {\r\n        var card_id = this.cards_nods[j].getComponent(\"card\").card_id\r\n        if (card_id == choose_card[i].cardid) {\r\n          console.log(\"destroy card id:\" + card_id)\r\n          //this.cards_nods[j].destroy()\r\n          this.cards_nods[j].removeFromParent(true);\r\n          destroy_card.push(this.cards_nods[j])\r\n          this.cards_nods.splice(j, 1)\r\n        }\r\n      }\r\n    }\r\n\r\n    this.appendCardsToOutZone(accountid, destroy_card)\r\n    this.updateCards()\r\n\r\n  },\r\n\r\n  //清除显示出牌节点全部子节点(就是把出牌的清空)\r\n  clearOutZone(accountid) {\r\n    var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n    var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n    var children = outCard_node.children;\r\n    for (var i = 0; i < children.length; i++) {\r\n      var card = children[i];\r\n      card.destroy()\r\n    }\r\n    outCard_node.removeAllChildren(true);\r\n  },\r\n  //对出的牌做排序\r\n  pushCardSort(cards) {\r\n    if (cards.length == 1) {\r\n      return\r\n    }\r\n    cards.sort(function (x, y) {\r\n      var a = x.getComponent(\"card\").card_data;\r\n      var b = y.getComponent(\"card\").card_data;\r\n\r\n      if (a.hasOwnProperty('value') && b.hasOwnProperty('value')) {\r\n        return b.value - a.value;\r\n      }\r\n      if (a.hasOwnProperty('king') && !b.hasOwnProperty('king')) {\r\n        return -1;\r\n      }\r\n      if (!a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return 1;\r\n      }\r\n      if (a.hasOwnProperty('king') && b.hasOwnProperty('king')) {\r\n        return b.king - a.king;\r\n      }\r\n    })\r\n  },\r\n\r\n  appendOtherCardsToOutZone(outCard_node, cards, yoffset) {\r\n    outCard_node.removeAllChildren(true);\r\n\r\n    //console.log(\"appendOtherCardsToOutZone length\"+cards.length)\r\n    //添加新的子节点\r\n    for (var i = 0; i < cards.length; i++) {\r\n      var card = cards[i];\r\n      outCard_node.addChild(card, 100 + i) //第二个参数是zorder,保证牌不能被遮住\r\n    }\r\n\r\n    //对出牌进行排序\r\n    //设置出牌节点的坐标\r\n    var zPoint = cards.length / 2;\r\n    //console.log(\"appendOtherCardsToOutZone zeroPoint:\"+zPoint)\r\n    for (var i = 0; i < cards.length; i++) {\r\n      var cardNode = outCard_node.getChildren()[i]\r\n      var x = (i - zPoint) * 30;\r\n      var y = cardNode.y + yoffset; //因为每个节点需要的Y不一样，做参数传入\r\n      //console.log(\"-----cardNode: x:\"+x+\" y:\"+y)\r\n      cardNode.setScale(0.5, 0.5);\r\n      cardNode.setPosition(x, y);\r\n\r\n    }\r\n  },\r\n  //将 “选中的牌” 添加到出牌区域\r\n  //destroy_card是玩家本次出的牌\r\n  appendCardsToOutZone(accountid, destroy_card) {\r\n    if (destroy_card.length == 0) {\r\n      return\r\n    }\r\n    //先给本次出的牌做一个排序\r\n    this.pushCardSort(destroy_card)\r\n    //console.log(\"appendCardsToOutZone\")\r\n    var gameScene_script = this.node.parent.getComponent(\"gameScene\")\r\n    //获取出牌区域节点\r\n    var outCard_node = gameScene_script.getUserOutCardPosByAccount(accountid)\r\n    this.appendOtherCardsToOutZone(outCard_node, destroy_card, 360)\r\n    //sconsole.log(\"OutZone:\"+outCard_node.name)\r\n\r\n  },\r\n\r\n  //重新排序手上的牌,并移动\r\n  updateCards() {\r\n\r\n    var zeroPoint = this.cards_nods.length / 2;\r\n    //var last_card_x = this.cards_nods[this.cards_nods.length-1].x\r\n    for (var i = 0; i < this.cards_nods.length; i++) {\r\n      var cardNode = this.cards_nods[i]\r\n      var x = (i - zeroPoint) * (this.card_width * 0.4);\r\n      cardNode.setPosition(x, -250);\r\n    }\r\n\r\n  },\r\n\r\n  playPushCardSound(card_name) {\r\n    console.log(\"playPushCardSound:\" + card_name)\r\n\r\n    if (card_name == \"\") {\r\n      return\r\n    }\r\n\r\n    switch (card_name) {\r\n      case CardsValue.one.name:\r\n        break\r\n      case CardsValue.double.name:\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/duizi.mp3\"))\r\n        }\r\n        break\r\n    }\r\n  },\r\n  // update (dt) {},\r\n  onButtonClick(event, customData) {\r\n    switch (customData) {\r\n      case \"btn_qiandz\":\r\n        console.log(\"btn_qiandz\")\r\n        myglobal.socket.requestRobState(qian_state.qian)\r\n        this.robUI.active = false\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_jiao_di_zhu.ogg\"))\r\n        }\r\n        break\r\n      case \"btn_buqiandz\":\r\n        console.log(\"btn_buqiandz\")\r\n        myglobal.socket.requestRobState(qian_state.buqiang)\r\n        this.robUI.active = false\r\n        if (isopen_sound) {\r\n          cc.audioEngine.play(cc.url.raw(\"resources/sound/woman_bu_jiao.ogg\"))\r\n        }\r\n        break\r\n      case \"nopushcard\":  //不出牌\r\n        myglobal.socket.request_buchu_card([], null)\r\n        this.playingUI_node.active = false\r\n        break\r\n      case \"pushcard\":   //出牌\r\n        //先获取本次出牌数据\r\n        if (this.choose_card_data.length == 0) {\r\n          this.tipsLabel.string = \"请选择牌!\"\r\n          setTimeout(function () {\r\n            this.tipsLabel.string = \"\"\r\n          }.bind(this), 2000);\r\n        }\r\n        myglobal.socket.request_chu_card(this.choose_card_data, function (err, data) {\r\n\r\n          if (err) {\r\n            console.log(\"request_chu_card:\" + err)\r\n            console.log(\"request_chu_card\" + JSON.stringify(data))\r\n            if (this.tipsLabel.string == \"\") {\r\n              this.tipsLabel.string = data.msg\r\n              setTimeout(function () {\r\n                this.tipsLabel.string = \"\"\r\n              }.bind(this), 2000);\r\n            }\r\n\r\n            //出牌失败，把选择的牌归位\r\n            for (var i = 0; i < this.cards_nods.length; i++) {\r\n              var card = this.cards_nods[i]\r\n              card.emit(\"reset_card_flag\")\r\n            }\r\n            this.choose_card_data = []\r\n          } else {\r\n            //出牌成功\r\n            console.log(\"resp_chu_card data:\" + JSON.stringify(data))\r\n            this.playingUI_node.active = false\r\n            //播放出牌的声音\r\n            //resp_chu_card data:{\"account\":\"2519901\",\"msg\":\"sucess\",\"cardvalue\":{\"name\":\"Double\",\"value\":1}}\r\n            //{\"type\":\"other_chucard_notify\",\"result\":0,\"data\":{\"accountid\":\"2519901\",\"cards\":[{\"cardid\":24,\"card_data\":{\"index\":24,\"value\":6,\"shape\":1}},{\"cardid\":26,\"card_data\":{\"index\":26,\"value\":6,\"shape\":3}}]},\"callBackIndex\":0}\r\n            this.playPushCardSound(data.cardvalue.name)\r\n            this.destoryCard(data.account, this.choose_card_data)\r\n            this.choose_card_data = []\r\n\r\n          }\r\n\r\n        }.bind(this))\r\n        //this.playingUI_node.active = false\r\n        break\r\n      case \"tipcard\":\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n\r\n});\r\n"]}